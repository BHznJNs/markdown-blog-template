{"version":3,"file":"index.min.js","sources":["../src/scripts/fetchResources.js","../src/utils/languageSelector.js","../src/utils/unOverridedError.js","../src/scripts/importers/dynamicImporter.js","../src/scripts/importers/style.js","../src/scripts/importers/highlight.js","../src/scripts/importers/katex.js","../src/utils/debounce.js","../src/utils/eventbus/inst.js","../src/utils/eventbus/index.js","../src/utils/mergeObj.js","../src/scripts/importers/charts/importer.js","../src/scripts/importers/charts/echarts.js","../src/scripts/importers/umd.js","../src/scripts/importers/charts/flowchart.js","../src/scripts/importers/charts/sequence.js","../src/scripts/importers/charts/gantt.js","../src/scripts/importers/charts/railroad.js","../src/scripts/importers/charts/qrcode.js","../src/scripts/importers/charts/index.js","../src/utils/dom/el.js","../src/utils/countWord.js","../src/utils/htmlEntityReplace.js","../src/utils/markdown/utils/getInterval.js","../src/utils/markdown/inline.js","../src/utils/markdown/node.js","../src/utils/markdown/utils/getIndent.js","../src/utils/markdown/resolvers/listResolver.js","../src/utils/markdown/resolvers/quoteResolver.js","../src/utils/markdown/resolvers/tableResolver.js","../src/utils/markdown/resolvers/blockResolvers.js","../src/utils/markdown/index.js","../src/utils/markdown/utils/getLines.js","../src/utils/dom/keydownEvent.js","../src/utils/dom/scrollControl.js","../src/scripts/iframeController.js","../src/scripts/articleRenderer.js","../src/scripts/indexRenderer.js","../src/scripts/pathManager.js","../src/components/paging.js","../src/scripts/mainManager.js","../src/index.js"],"sourcesContent":["let controller = null\r\n\r\nexport async function fetchJSON(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            const json = await res.json()\r\n            controller = null\r\n            return json\r\n        })\r\n        .catch(err => {\r\n            console.log(\"JSON request error: \" + path)\r\n            console.error(err)\r\n            return null\r\n        })\r\n}\r\n\r\nexport async function fetchMD(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            if (res.status != 200) {\r\n                throw res.status\r\n            }\r\n            const text = await res.text()\r\n            controller = null\r\n            return text\r\n        })\r\n        .catch(err => {\r\n            if (typeof err != \"number\") {\r\n                console.error(err)\r\n                return null\r\n            }\r\n\r\n            switch (err) {\r\n                // render error code in markdown format\r\n                case 404:\r\n                    return \"# 404 Not Found\"\r\n                case 500:\r\n                    return \"# 500 Internal Server Error\"\r\n                case DOMException:\r\n                    console.error(err)\r\n                    break\r\n                default:\r\n                    console.log(\"Markdown request error: \" + path)\r\n                    console.error(err)\r\n                    return \"# Unexpected request error\"\r\n            }\r\n        })\r\n}\r\n","import config from \"../../build.config.js\"\r\n\r\nconst currentLang = config.language\r\nconst langList = [\"zh\", \"en\"]\r\nfunction languageSelectorCreator(lang) {\r\n    for (const [index, langName] of Object.entries(langList)) {\r\n        if (lang === langName) {\r\n            return (...selections) => selections[index]\r\n        }\r\n    }\r\n    console.warn(\"Unexpected language: \" + lang)\r\n    // default returns English text\r\n    return (...selections) => selections[1]\r\n}\r\nconst languageSelector = languageSelectorCreator(currentLang)\r\nexport default languageSelector\r\n","export default class UnOverridedError extends Error {\r\n    constructor(name) {\r\n        super()\r\n        this.message =\r\n            `\"${name}\" is a abstract method that should be overrided.`\r\n    }\r\n}\r\n","import languageSelector from \"../../utils/languageSelector.js\"\r\nimport UnOverridedError from \"../../utils/unOverridedError.js\"\r\n\r\nexport default class DynamicImporter {\r\n    static loadErrMsg   = languageSelector(\"加载失败\", \"load error\")\r\n    static renderErrMsg = languageSelector(\"渲染失败\", \"render error\")\r\n\r\n    name = \"\"\r\n    _module = null\r\n    _targetElList = null\r\n\r\n    async importModule(props) { throw new UnOverridedError(\"importModule\") }\r\n    async beforeRender(props) {}\r\n    loadCondition(props) { throw new UnOverridedError(\"loadCondition\") }\r\n    renderItem(el) { throw new UnOverridedError(\"renderItem\") }\r\n\r\n    renderAll(props) {\r\n        for (const el of this._targetElList()) {\r\n            try {\r\n                this.renderItem(el)\r\n            } catch(err) {\r\n                this.renderErrResolver(err, el)\r\n            }\r\n        }\r\n    }\r\n\r\n    loadErrResolver(err) {\r\n        console.error(err)\r\n        this._targetElList().forEach(el =>\r\n            el.textContent = this.name + \" \" + DynamicImporter.loadErrMsg)\r\n    }\r\n    renderErrResolver(err, el) {\r\n        console.error(err)\r\n        el.textContent = this.name + \" \" + DynamicImporter.renderErrMsg\r\n    }\r\n\r\n    async render(props) {\r\n        if (!this.loadCondition(props)) {\r\n            return\r\n        }\r\n        if (this._module === null) {\r\n            try {\r\n                this._module = await this.importModule(props)\r\n            } catch(err) {\r\n                this.loadErrResolver(err)\r\n                return\r\n            }\r\n        }\r\n        await this.beforeRender(props)\r\n        this.renderAll(props)\r\n    }\r\n}\r\n","export default function importStyle(path) {\r\n    return new Promise((resolve, reject) => {\r\n        const linkEl = document.createElement(\"link\")\r\n        linkEl.rel  = \"stylesheet\"\r\n        linkEl.href = path\r\n        document.head.appendChild(linkEl)\r\n\r\n        linkEl.onload = resolve\r\n        linkEl.onerror = reject\r\n    })\r\n}\r\n","import DynamicImporter from \"./dynamicImporter.js\"\r\nimport importStyle from \"./style.js\"\r\n\r\nclass HighlightImporter extends DynamicImporter {\r\n    name = \"Highlight.js\"\r\n    _targetElList = () => document.querySelectorAll(\"pre.code-block code\")\r\n\r\n    async #importLangDefs(languageList=[]) {\r\n        const langDefImporters = languageList\r\n            .filter(name => !this._module.getLanguage(name))\r\n            .map(lang => import(`../../libs/highlight-es/languages/${lang.toLowerCase()}.js`))\r\n        await Promise.all(langDefImporters)\r\n            .then(langDefs => langDefs.forEach((defModule, index) => {\r\n                const name = languageList[index]\r\n                const def  = defModule.default\r\n                this._module.registerLanguage(name, def)\r\n            }))\r\n            .catch(this.loadErrResolver)\r\n    }\r\n\r\n    loadCondition(languageList) {\r\n        return languageList.size > 0\r\n    }\r\n\r\n    renderItem(el) {\r\n        this._module.highlightElement(el)\r\n\r\n    }\r\n    async beforeRender(languageList=new Set()) {\r\n        await this.#importLangDefs(Array.from(languageList))\r\n    }\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/highlight-es/github-dark.css\")\r\n        const module = await import(\"../../libs/highlight-es/highlight.min.js\")\r\n        return module.default\r\n    }\r\n}\r\n\r\nconst inst = new HighlightImporter()\r\nexport default inst.render.bind(inst)\r\n","import importStyle from \"./style.js\"\r\nimport DynamicImporter from \"./dynamicImporter.js\"\r\nimport config from \"../../../build.config.js\"\r\n\r\nconst { katexOptions } = config\r\n\r\nclass KatexImporter extends DynamicImporter {\r\n    name = \"KaTeX\"\r\n    _targetElList = () => document.querySelectorAll(\".math\")\r\n\r\n    loadCondition(isContainsFormula) {\r\n        return isContainsFormula\r\n    }\r\n\r\n    renderErrResolver(err, el) {\r\n        const texString = el.textContent\r\n        if (err instanceof this._module.ParseError) {\r\n            // KaTeX can't parse the expression\r\n            el.innerHTML = (\"Error in LaTeX '\" + texString + \"': \" + err.message)\r\n                .replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\r\n        } else {\r\n            // other error\r\n            el.textContent = this.name + \" \" + DynamicImporter.renderErrMsg\r\n            console.error(err)\r\n        }\r\n    }\r\n    renderItem(el) {\r\n        const texString = el.textContent\r\n        this._module.render(texString, el, katexOptions)\r\n    }\r\n\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/katex/katex.min.css\")\r\n        const module = await import(\"../../libs/katex/katex.min.js\")\r\n        return module.default\r\n    }\r\n}\r\n\r\nconst inst = new KatexImporter()\r\nexport default inst.render.bind(inst)\r\n","export default function(callback, waitMillisecond) {\r\n    let timer = null\r\n\r\n    return function(...args) {\r\n        if (timer) {\r\n            clearTimeout(timer)\r\n        }\r\n\r\n        timer = setTimeout(() => {\r\n            return callback(...args)\r\n        }, waitMillisecond)\r\n    }\r\n}","import EventBus from \"./index.js\"\r\nconst eventbus = new EventBus()\r\nexport default eventbus\r\n","export default class EventBus {\r\n    // A map used to store events and handlers for events\r\n    events = new Map()\r\n\r\n    /**\r\n     * @name emit\r\n     * @description to trigger the handlers for the given event name\r\n     * @param { String | Symbol } name event name\r\n     * @param { Array<any> }      args use `...` to support multi-arg\r\n     */\r\n    emit(name, ...args) {\r\n        const targetEvent = this.events.get(name)\r\n\r\n        if (targetEvent) {\r\n            targetEvent.forEach((handler) => {\r\n                handler.apply(null, args)\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @name on\r\n     * @description to add event listener & register the given event handler\r\n     * @param { String | Symbol } name event name\r\n     * @param { EventHandler } handler given handler to given event\r\n     */\r\n    on(name, handler) {\r\n        const targetEvent = this.events.get(name)\r\n\r\n        if (targetEvent) {\r\n            targetEvent.push(handler)\r\n        } else {\r\n            this.events.set(name, [handler])\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @name off\r\n     * @description remove the given handler to the given event\r\n     * @param { String | Symbol } name event name\r\n     * @param { EventHandler } handler given handler to given event\r\n     */\r\n    off(name, handler) {\r\n        const targetEvent = this.events.get(name)\r\n\r\n        if (targetEvent) {\r\n            if (targetEvent.length === 1) {\r\n                this.events.delete(name)\r\n            } else {\r\n                const handlerIndex = targetEvent.indexOf(handler)\r\n                targetEvent.splice(handlerIndex, 1)\r\n            }\r\n        }\r\n    }\r\n}","export default \r\nfunction mergeObj(destObj={}, srcObj={}) {\r\n    for (const key of Object.keys(srcObj)) {\r\n        const isDestKeyObj = typeof destObj[key] === \"object\"\r\n        const isSrcKeyObj  = typeof srcObj [key] === \"object\"\r\n        const isKeyInDest  = key in destObj\r\n\r\n        if (isKeyInDest && !isDestKeyObj) {\r\n            continue\r\n        }\r\n        if (isKeyInDest && isDestKeyObj) {\r\n            if (isSrcKeyObj) {\r\n                mergeObj(destObj[key], srcObj[key])\r\n            }\r\n            continue\r\n        }\r\n        if (!isKeyInDest) {\r\n            if (isSrcKeyObj) {\r\n                let clonedObj\r\n                if (typeof structuredClone !== \"undefined\") {\r\n                    // if browser supports `structuredClone`\r\n                    clonedObj = structuredClone(srcObj[key])\r\n                } else {\r\n                    clonedObj = JSON.parse(JSON.stringify(srcObj[key]))\r\n                }\r\n                destObj[key] = clonedObj\r\n            } else {\r\n                destObj[key] = srcObj[key]\r\n            }\r\n        }\r\n    }\r\n    return destObj\r\n}\r\n","import DynamicImporter from \"../dynamicImporter.js\"\r\nimport languageSelector from \"../../../utils/languageSelector.js\"\r\nimport UnOverridedError from \"../../../utils/unOverridedError.js\"\r\n\r\nexport default class ChartImporter extends DynamicImporter {\r\n    static loadErrMsg   = languageSelector(\"图表加载失败\", \"Chart load error\")\r\n    static renderErrMsg = languageSelector(\"图表渲染失败\", \"Chart render error\")\r\n\r\n    name = undefined\r\n\r\n    loadCondition() { return true }\r\n\r\n    loadErrResolver(err) {\r\n        console.error(err)\r\n        this._targetElList().forEach(el =>\r\n            el.textContent = ChartImporter.loadErrMsg)\r\n    }\r\n    renderErrResolver(err, el) {\r\n        console.error(err)\r\n        el.textContent = ChartImporter.renderErrMsg\r\n    }\r\n\r\n    renderItem(el, chartContent) { throw new UnOverridedError(\"renderItem\") }\r\n    renderAll() {\r\n        for (const el of this._targetElList()) {\r\n            const chartContent = el.__ChartContent__\r\n            try {\r\n                this.renderItem(el, chartContent)\r\n            } catch(err) {\r\n                this.renderErrResolver(err, el)\r\n            }\r\n        }\r\n    }\r\n}\r\n","import config from \"../../../../build.config.js\"\r\nimport debounce from \"../../../utils/debounce.js\"\r\nimport eventbus from \"../../../utils/eventbus/inst.js\"\r\nimport mergeObj from \"../../../utils/mergeObj.js\"\r\nimport ChartImporter from \"./importer.js\"\r\n\r\nlet [\r\n    echarts,\r\n    importChart,\r\n    importComponent,\r\n] = [null, null, null]\r\nconst globalOptions = config.echartsOptions\r\n\r\nfunction chartOptionResolver(options={}, libsToImport) {\r\n    const ignoredProps = [\r\n        \"width\",\r\n        \"height\",\r\n        \"color\",\r\n        \"backgroundColor\",\r\n        \"darkMode\",\r\n        \"textStyle\",\r\n        \"aria\",\r\n        \"axisPointer\",\r\n        \"animation\",\r\n        \"animationThreshold\",\r\n        \"animationDuration\",\r\n        \"animationEasing\",\r\n        \"animationDelay\",\r\n        \"animationDurationUpdate\",\r\n        \"animationEasingUpdate\",\r\n        \"animationDelayUpdate\",\r\n        \"stateAnimation\",\r\n        \"blendMode\",\r\n        \"hoverLayerThreshold\",\r\n        \"options\",\r\n        \"useUTC\",\r\n        \"media\",\r\n    ]\r\n\r\n    for (const key in options) {\r\n        if (ignoredProps.includes(key)) {\r\n            continue\r\n        }\r\n        if (key === \"series\") {\r\n            const { series } = options\r\n            if (!(series instanceof Array)) {\r\n                libsToImport.charts.add(series.type)\r\n                continue\r\n            }\r\n            for (const item of series) {\r\n                if (!(\"type\" in item)) {\r\n                    continue\r\n                }\r\n                libsToImport.charts.add(item.type)\r\n            }\r\n            continue\r\n        }\r\n\r\n        switch (key) {\r\n            case \"xAxis\":\r\n            case \"yAxis\":\r\n                libsToImport.components.add(\"grid\")\r\n                continue\r\n            case \"radiusAxis\":\r\n            case \"angleAxis\":\r\n                libsToImport.components.add(\"polar\")\r\n                continue\r\n            case \"parallelAxis\":\r\n                libsToImport.components.add(\"parallel\")\r\n                continue\r\n        }\r\n        libsToImport.components.add(key)\r\n    }\r\n}\r\n\r\nfunction specificChartResolver(options, isDarkMode) {\r\n    let resultObj = options\r\n    if (isDarkMode && \"calendar\" in options) {\r\n        const calendarChartDarkModeOptions = {\r\n            splitLine : { lineStyle: { color: \"white\" } },\r\n            dayLabel  : { color: \"#eee\" },\r\n            monthLabel: { color: \"#eee\" },\r\n            itemStyle : {\r\n                color : \"none\",\r\n                borderWidth: 0.5,\r\n            },\r\n        }\r\n        if (options.calendar instanceof Array) {\r\n            options.calendar.forEach(obj =>\r\n                mergeObj(obj, calendarChartDarkModeOptions))\r\n        } else {\r\n            mergeObj(options.calendar, calendarChartDarkModeOptions)\r\n        }\r\n    }\r\n    return resultObj\r\n}\r\n\r\nasync function importChartLibs(chartOptions) {\r\n    const libsToImport = {\r\n        charts: new Set(),\r\n        components: new Set(),\r\n    }\r\n    chartOptionResolver(globalOptions, libsToImport)\r\n    chartOptions.forEach(options =>\r\n        chartOptionResolver(options, libsToImport))\r\n\r\n    const chartsToImport = Array.from(libsToImport.charts).map(importChart)\r\n    const componentsToImport = Array.from(libsToImport.components).map(importComponent)\r\n    await Promise.all(chartsToImport.concat(componentsToImport))\r\n        .then(echarts.use)\r\n}\r\n\r\nclass EchartsImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".echarts-container\")\r\n\r\n    // event listeners\r\n    #darkmodeObserver = new MutationObserver(_ => {\r\n        for (const el of this._targetElList()) {\r\n            // rerender all chart elements to reset color theme\r\n            this._module.dispose(el)\r\n            this.renderItem(el)\r\n        }\r\n    })\r\n    #resizeEvent() {\r\n        this._targetElList()\r\n            .forEach(el =>\r\n                echarts.getInstanceByDom(el).resize())\r\n    }\r\n    #sizeSetter(el, options) {\r\n        if (options.width) {\r\n            el.style.width = options.width + \"px\"\r\n            delete options.width\r\n        }\r\n        if (options.height) {\r\n            el.style.height = options.height + \"px\"\r\n            delete options.height\r\n        }\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    renderItem(el) {\r\n        this.#sizeSetter(el, el.__ChartOptions__)\r\n\r\n        const isDarkMode = document.body.classList.contains(\"dark\")\r\n        const renderMode = isDarkMode ? \"another-dark\" : \"light\"\r\n        const chartInst  = this._module.init(el, renderMode)\r\n\r\n        // options clone\r\n        const globalOptionsCloned = structuredClone(globalOptions)\r\n        const currentOptionsCloned = structuredClone(el.__ChartOptions__)\r\n        // options merge\r\n        const specificResolved = specificChartResolver(currentOptionsCloned, isDarkMode)\r\n        const finalOptions = mergeObj(globalOptionsCloned, specificResolved)\r\n        chartInst.setOption(finalOptions)\r\n    }\r\n\r\n    async beforeRender() {\r\n        const chartOptions = Array.from(this._targetElList())\r\n            .map(el => el.__ChartOptions__)\r\n        try {\r\n            await importChartLibs(chartOptions)\r\n        } catch(err) {\r\n            this.loadErrResolver(err)\r\n        }\r\n    }\r\n\r\n    async importModule() {\r\n        const [module, darkTheme] = await Promise.all([\r\n            import(\"../../../libs/echarts/core.js\"),\r\n            import(\"./echartsAnotherDarkTheme.js\"),\r\n        ])\r\n        echarts         = module.default\r\n        importChart     = module.importChart\r\n        importComponent = module.importComponent\r\n        echarts.registerTheme(\"another-dark\", darkTheme.default)\r\n\r\n        // dark mode toggling listener\r\n        const body = document.body\r\n        this.#darkmodeObserver.observe(body, {\r\n            attributes: true,\r\n            attributeFilter: [\"class\"]\r\n        })\r\n\r\n        // resize event listeners\r\n        eventbus.on(\"catalog-toggle\", () => {\r\n            setTimeout(this.#resizeEvent.bind(this), 1000)\r\n        })\r\n        window.addEventListener(\"resize\",\r\n            debounce(this.#resizeEvent.bind(this), 200))\r\n        return echarts\r\n    }\r\n}\r\n\r\nconst inst = new EchartsImporter()\r\nexport default inst.render.bind(inst)\r\n","export default function umdImporter(path, name) {\r\n    const scriptEl = document.createElement(\"script\")\r\n    scriptEl.src   = path\r\n    scriptEl.type  = \"text/javascript\"\r\n    document.head.appendChild(scriptEl)\r\n    return new Promise((resolve, reject) => {\r\n        scriptEl.onload = function() {\r\n            if (!(name in globalThis)) {\r\n                const errMsg = `Module ${name} does not support this import method.`\r\n                console.error(errMsg)\r\n                reject(errMsg)\r\n            }\r\n\r\n            const localModuleObj = globalThis[name]\r\n            globalThis[name] = undefined\r\n            resolve(localModuleObj)\r\n        }\r\n        scriptEl.onerror = function(err) {\r\n            console.error(`Error loading dynamically imported module \"${name}\": ${path}`)\r\n            reject(err)\r\n        }\r\n    })\r\n}\r\n","import ChartImporter from \"./importer.js\"\r\nimport umdImporter from \"../umd.js\"\r\nimport config from \"../../../../build.config.js\"\r\n\r\nglobalThis.raphael = null\r\nconst { flowchartOptions } = config\r\n\r\nclass FlowchartImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".flowchart-container\")\r\n\r\n    constructor() { super() }\r\n\r\n    renderItem(el, chartContent) {\r\n        const chartInst = this._module.parse(chartContent)\r\n        chartInst.drawSVG(el, flowchartOptions)\r\n    }\r\n\r\n    async importModule() {\r\n        globalThis.raphael = await umdImporter(\"./dist/libs/flowchart.js/raphael.min.js\", \"raphael\")\r\n        const flowchartModule = await umdImporter(\"./dist/libs/flowchart.js/flowchart.min.js\", \"flowchart\")\r\n        return flowchartModule\r\n    }\r\n}\r\n\r\nconst inst = new FlowchartImporter()\r\nexport default inst.render.bind(inst)\r\n","import ChartImporter from \"./importer.js\"\r\n\r\nclass SequenceImport extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".sequencechart-container\")\r\n\r\n    constructor() { super() }\r\n\r\n    renderItem(el, chartContent) {\r\n        const diagram = new this._module(chartContent)\r\n        el.appendChild(diagram.dom())\r\n    }\r\n\r\n    async importModule() {\r\n        const module = await import(\"../../../libs/sequence-diagram/sequence-diagram-web.mjs\")\r\n        return module.SequenceDiagram\r\n    }\r\n}\r\n\r\nconst inst = new SequenceImport()\r\nexport default inst.render.bind(inst)\r\n","import importStyle from \"../style.js\"\r\nimport config from \"../../../../build.config.js\"\r\nimport ChartImporter from \"./importer.js\"\r\n\r\nconst { language, ganttOptions } = config\r\n\r\nif (!(\"language\" in ganttOptions)) {\r\n    // set language of gantt charts as default\r\n    ganttOptions.language = language\r\n}\r\n\r\nclass GanttImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".ganttchart-container\")\r\n\r\n    renderItem(el, chartContent) {\r\n        new this._module(el, chartContent, ganttOptions)\r\n    }\r\n\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/frappe-gantt/frappe-gantt.min.css\")\r\n        const module = await import(\"../../../libs/frappe-gantt/frappe-gantt.min.js\")\r\n        return module.default\r\n    }\r\n}\r\n\r\nconst inst = new GanttImporter()\r\nexport default inst.render.bind(inst)\r\n","import importStyle from \"../style.js\"\r\nimport ChartImporter from \"./importer.js\"\r\nimport config from \"../../../../build.config.js\"\r\n\r\nlet railroadRenderOptions = null\r\nconst { railroadOptions } = config\r\nconst ASCIIPattern = /[\\x00-\\x7F]/\r\nconst CJKPattern   = /['\"]([^'\"]*[/\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}]+[^'\"]*)['\"]/gu\r\n\r\nclass RailroadImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".railroad-container\")\r\n\r\n    renderItem(el, chartContent=\"\") {\r\n        const CHAR_WIDTH_before = railroadRenderOptions.CHAR_WIDTH\r\n        const containsCJK = CJKPattern.test(chartContent)\r\n        const isAllContainsASCII = (chartContent.match(CJKPattern) || [])\r\n            .map(matchItem => matchItem.slice(1, -1))\r\n            .every(item => ASCIIPattern.test(item))\r\n        const targetCharWidth = containsCJK\r\n            && (isAllContainsASCII ? 13 : 14)\r\n            || railroadRenderOptions.CHAR_WIDTH\r\n        if (railroadRenderOptions.CHAR_WIDTH < targetCharWidth) {\r\n            railroadRenderOptions.CHAR_WIDTH = targetCharWidth\r\n        }\r\n\r\n        const renderArgs = this._module.concat(el)\r\n        const renderFn = new Function(\r\n            \"Diagram\",\r\n            \"ComplexDiagram\",\r\n            \"Sequence\",\r\n            \"Stack\",\r\n            \"OptionalSequence\",\r\n            \"AlternatingSequence\",\r\n            \"Choice\",\r\n            \"HorizontalChoice\",\r\n            \"MultipleChoice\",\r\n            \"Optional\",\r\n            \"OneOrMore\",\r\n            \"ZeroOrMore\",\r\n            \"Group\",\r\n            \"Start\",\r\n            \"End\",\r\n            \"Terminal\",\r\n            \"NonTerminal\",\r\n            \"Comment\",\r\n            \"Skip\",\r\n            \"Block\",\r\n            \"targetElement\",\r\n            chartContent + \".addTo(targetElement)\",\r\n        )\r\n        renderFn.apply(null, renderArgs)\r\n        // restore CHAR_WIDTH\r\n        railroadRenderOptions.CHAR_WIDTH = CHAR_WIDTH_before\r\n    }\r\n\r\n    async importModule() {\r\n        importStyle(\"./dist/libs/railroad-diagrams/railroad.css\")\r\n        const module = await import(\"../../../libs/railroad-diagrams/railroad.min.js\")\r\n        const {\r\n            default: rr,\r\n            Options,\r\n        } = module\r\n        Object.assign(Options, {\r\n            VS                : railroadOptions.verticalGap,\r\n            AR                : railroadOptions.arcRadius,\r\n            INTERNAL_ALIGNMENT: railroadOptions.internalAlignment,\r\n            CHAR_WIDTH        : railroadOptions.charWidth,\r\n            COMMENT_CHAR_WIDTH: railroadOptions.commentCharWidth,\r\n        })\r\n        railroadRenderOptions = Options\r\n        return [\r\n            rr.Diagram,\r\n            rr.ComplexDiagram,\r\n            rr.Sequence,\r\n            rr.Stack,\r\n            rr.OptionalSequence,\r\n            rr.AlternatingSequence,\r\n            rr.Choice,\r\n            rr.HorizontalChoice,\r\n            rr.MultipleChoice,\r\n            rr.Optional,\r\n            rr.OneOrMore,\r\n            rr.ZeroOrMore,\r\n            rr.Group,\r\n            rr.Start,\r\n            rr.End,\r\n            rr.Terminal,\r\n            rr.NonTerminal,\r\n            rr.Comment,\r\n            rr.Skip,\r\n            rr.Block,\r\n        ]\r\n    }\r\n}\r\n\r\nconst inst = new RailroadImporter()\r\nexport default inst.render.bind(inst)\r\n","import umdImporter from \"../umd.js\"\r\nimport ChartImporter from \"./importer.js\"\r\nimport config from \"../../../../build.config.js\"\r\n\r\nconst { qrcodeOptions: globalQRCodeOptions } = config\r\n\r\nclass QRCodeImporter extends ChartImporter {\r\n    _targetElList = () => document.querySelectorAll(\".qrcode-container\")\r\n\r\n    // dark mode event listener\r\n    #darkmodeObserver = new MutationObserver(this.renderAll.bind(this))\r\n\r\n    renderItem(el) {\r\n        // get current front color and background color\r\n        const computedStyle    = getComputedStyle(document.body)\r\n        const frontColor       = computedStyle.getPropertyValue(\"--default-tx-color\")\r\n        const backgroundColor  = computedStyle.getPropertyValue(\"--chart-bg-color\")\r\n\r\n        const instOptions      = Object.assign({}, globalQRCodeOptions)\r\n        const qrcodeContent    = el.__QRCodeContent__\r\n        const qrcodeWidth      = instOptions.width || 256 // default width\r\n        instOptions.color      = frontColor\r\n        instOptions.background = backgroundColor\r\n        instOptions.content    = qrcodeContent\r\n            || instOptions.content // global qrcode content\r\n            || (() => {throw new Error(\"No QRCode content provided.\")})()\r\n\r\n        const qrcodeInst = new this._module(instOptions)\r\n        el.style.width   = qrcodeWidth + \"px\"\r\n        el.innerHTML     = qrcodeInst.svg()\r\n    }\r\n\r\n    async importModule() {\r\n        const QRCode = await umdImporter(\"./dist/libs/qrcode-svg/qrcode.min.js\", \"QRCode\")\r\n        const body = document.body\r\n        this.#darkmodeObserver.observe(body, {\r\n            attributes: true,\r\n            attributeFilter: [\"class\"]\r\n        })\r\n        return QRCode\r\n    }\r\n}\r\n\r\nconst inst = new QRCodeImporter()\r\nexport default inst.render.bind(inst)\r\n","import echartsRender from \"./echarts.js\"\r\nimport flowchartRender from \"./flowchart.js\"\r\nimport sequenceChartRender from \"./sequence.js\"\r\nimport ganttChartRender from \"./gantt.js\"\r\nimport railroadChartRender from \"./railroad.js\"\r\nimport qrcodeRender from \"./qrcode.js\"\r\n\r\nconst chartMethodMap = new Map([\r\n    [\"echarts\"       , echartsRender],\r\n    [\"flow-chart\"    , flowchartRender],\r\n    [\"sequence-chart\", sequenceChartRender],\r\n    [\"gantt-chart\"   , ganttChartRender],\r\n    [\"railroad-chart\", railroadChartRender],\r\n    [\"qrcode\"        , qrcodeRender],\r\n])\r\n\r\nexport default async function(chartTypeList=new Set()) {\r\n    for (const type of chartTypeList) {\r\n        if (!chartMethodMap.has(type)) {\r\n            console.error(\"Unknown chart type: \" + type)\r\n            continue\r\n        }\r\n        const targetChartLoadMethod = chartMethodMap.get(type)\r\n        await targetChartLoadMethod()\r\n    }\r\n}\r\n","function propSetter(el, props) {\r\n    if (!props) {\r\n        return\r\n    }\r\n    for (const [key, val] of Object.entries(props)) {\r\n        if (val === undefined) {\r\n            continue\r\n        }\r\n        if (val instanceof Function) {\r\n            el[key] = val\r\n        } else {\r\n            el.setAttribute(key, val)\r\n        }\r\n    }\r\n}\r\n\r\nfunction propToString(props) {\r\n    // input: {prop: \"value\"}\r\n    // output: \"prop='value'\"\r\n    const htmlValueFormater = val => val.toString().replaceAll(\"\\\"\", \"&quot;\") \r\n    const resultPropStr = Object.entries(props)\r\n        .filter(([_, val]) => val != undefined)\r\n        .map(([key, val]) => `${key}=\"${htmlValueFormater(val)}\"`)\r\n        .join(\" \")\r\n    return resultPropStr\r\n}\r\n\r\nfunction contentSetter(el, content) {\r\n    if (content instanceof Array) {\r\n        // array of html element\r\n        for (const childEl of content) {\r\n            el.appendChild(childEl)\r\n        }\r\n    } else if (content instanceof HTMLElement) {\r\n        // single element\r\n        el.appendChild(content)\r\n    } else if (typeof content === \"string\") {\r\n        // common text\r\n        el.textContent = content\r\n    } else {\r\n        throw Error(\"Unexpected element content: \" + content)\r\n    }\r\n}\r\n\r\nexport default function el(tagName, content=\"\", props=null) {\r\n    if (\"document\" in globalThis) {\r\n        // in browser\r\n        if (tagName === \"text\") {\r\n            return document.createTextNode(content)\r\n        }\r\n\r\n        const targetEl = document.createElement(tagName)\r\n        propSetter(targetEl, props)\r\n        contentSetter(targetEl, content)\r\n        return targetEl\r\n    } else {\r\n        // in node.js\r\n        if (content instanceof Array) {\r\n            content = content.join(\"\")\r\n        }\r\n        switch (tagName) {\r\n            case \"text\":\r\n                return content\r\n            case \"hr\":\r\n            case \"br\":\r\n                return `<${tagName}>`\r\n            case \"img\":\r\n            case \"input\":\r\n                return `<${tagName} ${props ? propToString(props) : \"\"}>`\r\n        }\r\n        return `<${tagName}${props ? \" \" + propToString(props) : \"\"}>${content}</${tagName}>`\r\n    }\r\n}\r\n","const cjkCharPattern = /[\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}]/gu\r\nconst euCharPattern  = /[A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u00FF]+/g\r\nconst grCharPattern  = /\\p{Script=Greek}+/gu\r\nconst arCharPattern  = /\\p{Script=Arabic}+/gu\r\nconst cyCharPattern  = /\\p{Script=Cyrillic}+/gu\r\nconst numberPattern  = /(\\-|\\+)?\\d+(\\.\\d+)?/g\r\n\r\nconst patternList = [\r\n    cjkCharPattern,\r\n    euCharPattern,\r\n    grCharPattern,\r\n    arCharPattern,\r\n    cyCharPattern,\r\n    numberPattern,\r\n]\r\n\r\nexport function tokenize(para=\"\") {\r\n    if (para.length === 0) {\r\n        return []\r\n    }\r\n\r\n    const tokenList = patternList\r\n        .map(pattern => {\r\n            const matched = para.match(pattern)\r\n            return matched || []\r\n        })\r\n        .reduce((accumulator, current) =>\r\n            accumulator.concat(current)\r\n        , [])\r\n\r\n    return tokenList\r\n}\r\n\r\nexport default function countWord(para=\"\") {\r\n    if (para.length === 0) {\r\n        return 0\r\n    }\r\n\r\n    const tokenList  = tokenize(para)\r\n    return tokenList.length\r\n}","export default source => source\r\n    .replaceAll(\"<\", \"&lt;\")\r\n    .replaceAll(\">\", \"&gt;\")\r\n","// (\"abc]\", \"]\") -> \"abc\"\r\nexport default function getInterval(text, endSign, includeEscape=false) {\r\n    if (!text.includes(endSign)) {\r\n        return null\r\n    }\r\n\r\n    let intervalText = \"\"\r\n    let isEscape = false\r\n\r\n    while (text.length) {\r\n        const ch = text.slice(0, 1)\r\n        text = text.substr(1)\r\n\r\n        if (ch === \"\\\\\") {\r\n            isEscape = !isEscape\r\n            if (!includeEscape) {\r\n                continue\r\n            }\r\n        }\r\n        if (ch === endSign && !isEscape) {\r\n            break\r\n        }\r\n        intervalText += ch\r\n        isEscape = false\r\n    }\r\n\r\n    return intervalText\r\n}\r\n","import el from \"../dom/el.js\"\r\nimport countWord from \"../countWord.js\"\r\nimport htmlEntityReplace from \"../htmlEntityReplace.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\n\r\n// identifier character to HTML tag\r\nconst KeyToken_TagName_map = new Map([\r\n    [\"#\", \"strong\"],\r\n    [\"`\", \"code\"],\r\n    [\"_\", \"u\"],\r\n    [\"/\", \"i\"],\r\n    [\"-\", \"del\"],\r\n    [\":\", \"span.dim\"],\r\n    [\",\", \"sub\"],\r\n    [\"'\", \"sup\"],\r\n    [\"$\", \"span.math\"],\r\n])\r\n\r\nconst PairedParenMap = new Map([\r\n    [\"[\", \"]\"],\r\n    [\"{\", \"}\"],\r\n])\r\n\r\n// --- --- --- --- --- ---\r\n\r\nlet katexRenderer = null\r\nif (typeof window === \"undefined\") {\r\n    const renderModule = await import(\"../../../builder/utils/renderer/index.js\")\r\n    katexRenderer = content => renderModule.render(content, \"katex\")\r\n}\r\n\r\nclass TextToken {\r\n    constructor(content) {\r\n        this.content = content\r\n    }\r\n    count  = () => countWord(this.content)\r\n    toHTML = () => el(\"text\", this.content)\r\n}\r\nclass KeyToken {\r\n    constructor(tagSign, content) {\r\n        const tag = KeyToken_TagName_map.get(tagSign)\r\n        if (tag.includes(\".\")) {\r\n            const [realTagName, className] = tag.split(\".\")\r\n            this.tagName = realTagName\r\n            this.className = className\r\n        } else {\r\n            this.tagName = tag\r\n        }\r\n        this.content = content\r\n\r\n        if (this.className === \"math\" && typeof window === \"object\") {\r\n            // set this global variable to import\r\n            // the math formula renderer module\r\n            globalThis.__ContainsFormula__ = true\r\n        }\r\n    }\r\n\r\n    count = () => countEntry(this.content)\r\n    toHTML() {\r\n        if (this.className === \"math\" && typeof window === \"undefined\") {\r\n            // for katex rendering in node.js\r\n            const filename = katexRenderer(this.content)\r\n            const formulaImage = el(\"img\", \"\", {\r\n                src: \"./\" + filename\r\n            })\r\n            const container = el(\"span\", formulaImage, {\r\n                \"class\": \"math\"\r\n            })\r\n            return container\r\n        }\r\n        const elOption = this.className === undefined ? null : {\"class\": this.className}\r\n        const thisEl = el(this.tagName, parseEntry(this.content), elOption)\r\n        return thisEl\r\n    }\r\n}\r\n\r\nclass LinkToken {\r\n    constructor(content, address) {\r\n        this.content = content\r\n        this.address = address\r\n    }\r\n\r\n    count = () => 0\r\n    toHTML() {\r\n        const displayContent = parseEntry(this.content)\r\n        if (this.address.startsWith(\"http\")) {\r\n            // internet links\r\n            return el(\"a\", displayContent, {\r\n                href: this.address,\r\n                target: \"_blank\"\r\n            })\r\n        }\r\n\r\n        if (this.address.startsWith(\"//\")) {\r\n            // relative link for some extra HTML files\r\n            return el(\"a\", displayContent, {\r\n                href: this.address.slice(2),\r\n            })\r\n        }\r\n\r\n        // static resources or links\r\n        const actualAddress = \"static/\" + this.address\r\n        return el(\"a\", displayContent, {\r\n            href: \"#\" + actualAddress\r\n        })\r\n    }\r\n}\r\nclass PhoneticToken {\r\n    constructor(content, notation) {\r\n        this.content  = content\r\n        this.notation = notation\r\n    }\r\n\r\n    count = () => countEntry(this.content)\r\n    toHTML() {\r\n        const ignoredLeftParenthesis = el(\"rp\", \"(\")\r\n        const ignoredRightParenthesis = el(\"rp\", \")\")\r\n        const notationEl = el(\"rt\", this.notation)\r\n\r\n        const content = parseEntry(this.content).concat([\r\n            ignoredLeftParenthesis,\r\n            notationEl,\r\n            ignoredRightParenthesis,\r\n        ])\r\n        return el(\"ruby\", content, {\r\n            \"data-notation\": this.notation\r\n        })\r\n    }\r\n}\r\n\r\n// --- --- --- --- --- ---\r\n\r\nfunction parser(source) {\r\n    function getFirstChar() {\r\n        const ch = source.charAt(0)\r\n        source = source.substring(1)\r\n        return ch\r\n    }\r\n    function getSpecialTokenClass(tokenSign) {\r\n        let targetTokenType\r\n        if (tokenSign === \"[\") {\r\n            targetTokenType = LinkToken\r\n        } else if (tokenSign === \"{\") {\r\n            targetTokenType = PhoneticToken\r\n        } else { /* unreachable */ }\r\n        return targetTokenType\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    const tokens = []\r\n    let textTerm = \"\" // text\r\n    let keyTerm  = \"\" // inline style content\r\n    let keyStart = \"\"\r\n    let isEscape = false\r\n    let isInKey  = false\r\n\r\n    while (source.length) {\r\n        const ch = getFirstChar()\r\n\r\n        // key rules resolve\r\n        if (KeyToken_TagName_map.has(ch)) {\r\n            if (isEscape) {\r\n                if (isInKey) {\r\n                    keyTerm += ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                isEscape = false\r\n                continue\r\n            }\r\n\r\n            if (isInKey && ch != keyStart) {\r\n                keyTerm += ch\r\n                continue\r\n            }\r\n\r\n            const nextCh = getFirstChar()\r\n            if (nextCh != ch) {\r\n                if (isInKey) {\r\n                    keyTerm += ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                source = nextCh + source\r\n                continue\r\n            }\r\n\r\n            if (isInKey) {\r\n                tokens.push(new KeyToken(ch, keyTerm))\r\n                keyTerm  = \"\"\r\n                keyStart = \"\"\r\n            } else {\r\n                tokens.push(new TextToken(textTerm))\r\n                textTerm = \"\"\r\n                keyStart = ch\r\n            }\r\n            isInKey = !isInKey\r\n            continue\r\n        }\r\n\r\n        // special inline rules resolve\r\n        if ([\"[\", \"{\"].includes(ch) && !isInKey && !isEscape) {\r\n            const specialTokenSign = ch\r\n            const pairedTokenSign = PairedParenMap.get(specialTokenSign)\r\n\r\n            tokens.push(new TextToken(textTerm))\r\n            textTerm = \"\"\r\n\r\n            let removedContent = specialTokenSign\r\n            // the actual displayed content for special inline elements\r\n            const displayContent = getInterval(source, pairedTokenSign, true)\r\n            if (displayContent != null) {\r\n                removedContent += source.slice(0, displayContent.length + 1)\r\n                source = source.substr(displayContent.length + 1)\r\n\r\n                const nextCh = getFirstChar()\r\n                removedContent += nextCh\r\n                if (nextCh === \"(\") {\r\n                    // the hidden displayed content for special inline elements\r\n                    const hiddenContent = getInterval(source, \")\")\r\n                    if (hiddenContent != null) {\r\n                        let targetTokenType = getSpecialTokenClass(specialTokenSign)\r\n                        source = source.substr(hiddenContent.length + 1)\r\n                        tokens.push(new targetTokenType(displayContent, hiddenContent))\r\n                        continue\r\n                    }\r\n                }\r\n            }\r\n            textTerm += removedContent\r\n            continue\r\n        }\r\n\r\n        // --- --- --- --- --- ---\r\n\r\n        if (ch === \"\\\\\") {\r\n            isEscape = !isEscape\r\n            continue\r\n        }\r\n\r\n        let text\r\n        if (isEscape) {\r\n            text = \"\\\\\" + ch\r\n            isEscape = false\r\n        } else {\r\n            text = ch\r\n        }\r\n\r\n        if (isInKey) {\r\n            keyTerm += text\r\n        } else {\r\n            textTerm += text\r\n        }\r\n    }\r\n\r\n    if (keyTerm.length) {\r\n        tokens.push(new KeyToken(keyStart, keyTerm))\r\n    }\r\n    if (textTerm.length) {\r\n        tokens.push(new TextToken(textTerm))\r\n    }\r\n    return tokens\r\n}\r\n\r\n// --- --- --- --- --- ---\r\n\r\nexport function countEntry(source) {\r\n    const tokens = parser(source)\r\n    const result = tokens.reduce((accumulator, current) =>\r\n        accumulator += current.count()\r\n    , 0)\r\n    return result\r\n}\r\n\r\nexport function getRawContent(source) {\r\n    const tokens = parser(source)\r\n    const resultContent = []\r\n\r\n    for (const token of tokens) {\r\n        if (token instanceof KeyToken && token.className === \"math\") {\r\n            continue\r\n        }\r\n        if (token instanceof LinkToken) {\r\n            continue\r\n        }\r\n        resultContent.push(token.content)\r\n    }\r\n\r\n    return resultContent.join(\"\")\r\n}\r\n\r\nexport function parseEntry(source) {\r\n    const tokens = parser(source)\r\n    const resultHTML = tokens\r\n        .filter(token =>\r\n            // remove empty TextToken\r\n            !(token instanceof TextToken && !token.content.length))\r\n        .map(token => token.toHTML())\r\n\r\n    if (typeof window !== \"object\" && source === resultHTML[0]) {\r\n        // for server rendering\r\n        return htmlEntityReplace(source)\r\n    }\r\n    return resultHTML\r\n}\r\n\r\n// test cases\r\n// console.log(parser(\"``\\\\```\"))\r\n// console.log(parseEntry(\"##bo//itelic//ld##\"))\r\n// console.log(parseEntry(\"##bo[link text](http://www.com)ld##\"))\r\n// console.log(parseEntry(\"::dim[link text](http://www.com)med::\"))\r\n// console.log(parseEntry(\"[http:\\\\/\\\\/www.com](http://www.com)\"))\r\n// console.log(parseEntry(\"//ita[link text](http:\\\\/\\\\/www.com)lic//\"))\r\n// console.log(parseEntry(\"``<test>``\"))\r\n// console.log(parseEntry(\"asd[asd\"))\r\n// console.log(parseEntry(\"asd[asd]asd\"))\r\n// console.log(parseEntry(\"asd[asd](asd\"))\r\n// console.log(parseEntry(\"asd[asd](asd)\"))\r\n// console.log(parseEntry(\"asd[##link##](asd)\"))\r\n// console.log(parseEntry(\"##asd[link##](asd)\"))\r\n// console.log(parseEntry(\"##asd[link](asd)##\"))\r\n// console.log(parseEntry(\"::dimmed::\"))\r\n// console.log(parseEntry(\"$$f_c = \\\\frac{1}{abc}$$\"))\r\n","import { countEntry, parseEntry } from \"./inline.js\"\r\nimport el from \"../dom/el.js\"\r\nimport languageSelector from \"../languageSelector.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\n\r\nexport class Headline {\r\n    constructor(content) {\r\n        // \"### test\" -> \"###\"\r\n        const splited = content.split(\" \")\r\n        const numberSignStr = splited[0]\r\n        let numberSignCount = 0\r\n        for (const ch of numberSignStr) {\r\n            if (ch === '#') {\r\n                numberSignCount += 1\r\n            }\r\n        }\r\n\r\n        if (numberSignCount > 6) {\r\n            numberSignCount = 0\r\n        }\r\n\r\n        const rawContent = splited.slice(1).join(\" \")\r\n        this.tagName = \"h\" + numberSignCount\r\n        this.content = rawContent\r\n    }\r\n    toHTML() {\r\n        const options = this.id === undefined\r\n            ? null\r\n            : { id: this.id }\r\n        const parsedContent = parseEntry(this.content)\r\n        return el(this.tagName, parsedContent, options)\r\n    }\r\n\r\n    static pattern = source => /^(#+ )/.test(source)\r\n}\r\n\r\nexport class Para {\r\n    tagName = \"p\"\r\n\r\n    constructor(content) {\r\n        this.content = content.trimStart()\r\n    }\r\n    toHTML() {\r\n        const inline = parseEntry(this.content)\r\n        return el(this.tagName, inline)\r\n    }\r\n}\r\n\r\nexport class Quote {\r\n    children = []\r\n    title    = \"\"\r\n    type     = Quote.NormalTypeEnum\r\n\r\n    constructor(children) {\r\n        const isAlertQuote = children[0] instanceof Para\r\n            && Quote.alertPattern(children[0].content)\r\n\r\n        if (!isAlertQuote) {\r\n            this.children = children\r\n            return\r\n        }\r\n\r\n        let defaultTitle\r\n        const titleLine  = children[0].content\r\n        const targetType = getInterval(titleLine.slice(1), \"]\")\r\n        switch (targetType.toLowerCase()) {\r\n            case \"note\": case \"笔记\":\r\n                this.type = Quote.NoteTypeEnum\r\n                defaultTitle = languageSelector(\"笔记\", \"Note\")\r\n                break\r\n            case \"tip\": case \"提示\":\r\n                this.type = Quote.TipTypeEnum\r\n                defaultTitle = languageSelector(\"提示\", \"Tip\")\r\n                break\r\n            case \"important\": case \"重要\":\r\n                this.type = Quote.ImportantTypeEnum\r\n                defaultTitle = languageSelector(\"重要\", \"Important\")\r\n                break\r\n            case \"warning\": case \"注意\":\r\n                this.type = Quote.warningTypeEnum\r\n                defaultTitle = languageSelector(\"注意\", \"Warning\")\r\n                break\r\n            case \"caution\": case \"警告\":\r\n                this.type = Quote.CautionTypeEnum\r\n                defaultTitle = languageSelector(\"警告\", \"Caution\")\r\n                break\r\n        }\r\n        const titleString = titleLine\r\n            .slice(targetType.length + 2)\r\n            .trimStart()\r\n        this.title = titleString || defaultTitle\r\n        this.children = children.slice(1)\r\n    }\r\n    toHTML() {\r\n        if (this.type === Quote.NormalTypeEnum) {\r\n            const innerNodes = this.children\r\n                .map(node => node.toHTML())\r\n            return el(\"blockquote\", innerNodes)\r\n        }\r\n        const headline = el(\"p\", this.title, {\r\n            \"class\": \"alert-title\"\r\n        })\r\n        const innerNodes = this.children\r\n            .map(node => node.toHTML())\r\n        return el(\"blockquote\", [headline].concat(innerNodes), {\r\n            \"class\": `alert ${this.type.description}`\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        (source === \">\") || source.startsWith(\"> \")\r\n    static alertPattern = source =>\r\n        /^\\[(.*)+\\].*/.test(source)\r\n\r\n    static NormalTypeEnum    = Symbol(\"normal\")\r\n    static NoteTypeEnum      = Symbol(\"note\")\r\n    static TipTypeEnum       = Symbol(\"tip\")\r\n    static ImportantTypeEnum = Symbol(\"important\")\r\n    static warningTypeEnum   = Symbol(\"warning\")\r\n    static CautionTypeEnum   = Symbol(\"caution\")\r\n}\r\n\r\nexport class Divider {\r\n    toHTML = () => el(\"hr\")\r\n    static pattern = source =>\r\n        source.match(/(-\\s*-\\s*-)|(\\*\\s*\\*\\s*\\*)/) && !source.match(/[a-zA-Z0-9]/)\r\n}\r\n\r\nexport class List {\r\n    children = []\r\n\r\n    constructor(content) {\r\n        this.isOrdered = List.orderedPattern(content)\r\n        this.tagName   = (this.isOrdered) ? \"ol\" : \"ul\"\r\n        this.children  = [List.getContent(content, this.isOrdered)]\r\n    }\r\n\r\n    toHTML() {\r\n        const childrenHTML = this.children.map(child => {\r\n            if (typeof child === \"string\") {\r\n                const inline = parseEntry(child)\r\n                return el(\"li\", inline)\r\n            } else {\r\n                return child.toHTML()\r\n            }\r\n        })\r\n        return el(this.tagName, childrenHTML)\r\n    }\r\n\r\n    static orderedPattern   = source => /^([\\s\\t]*[0-9]+. )/.test(source)\r\n    static unorderedPattern = source => /^([\\s\\t]*[+-] )/.test(source)\r\n    static taskListPattern  = source => /^[\\s\\t]*- \\[( |x|\\*)\\] /.test(source)\r\n    static isListPattern    = source => List.orderedPattern(source) || List.unorderedPattern(source)\r\n\r\n    static getContent(line, isOrdered) {\r\n        if (isOrdered) {\r\n            // \"1. ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[0-9]+. )).+$/g)[0]\r\n        } else if (this.taskListPattern(line)) {\r\n            // \"- [ ] ...\" | \"- [x] ...\" => \"...\"\r\n            const trimedLine = line.trimStart()\r\n            return new TaskListItem(trimedLine.slice(6), trimedLine.slice(0, 6))\r\n        } else if (this.unorderedPattern(line)) {\r\n            // \"- ...\" | \"+ ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[+-]+ )).+$/g)[0]\r\n        } else {\r\n            throw new Error(\"Unexpected list item: \" + line)\r\n        }\r\n    }\r\n}\r\n\r\nclass TaskListItem {\r\n    constructor(content, prefix) {\r\n        this.content = content\r\n        this.isChecked = prefix[3] === \"x\" || prefix[3] === \"*\"\r\n    }\r\n    count() {\r\n        return countEntry(this.content)\r\n    }\r\n    toHTML() {\r\n        const inputEl = el(\"input\", \"\", {\r\n            type: \"checkbox\",\r\n            checked: this.isChecked ? true : undefined,\r\n        })\r\n        const contentEl = el(\"text\", this.content)\r\n        const listItemEl = el(\"li\", [inputEl, contentEl], {\r\n            \"class\": \"task-list-item\"\r\n        })\r\n        return listItemEl\r\n    }\r\n}\r\n\r\nexport class Table {\r\n    headerCells = [\"\"]   // [string]\r\n    bodyRows    = [[\"\"]] // [[string]]\r\n\r\n    constructor(headerCells, bodyRows) {\r\n        this.headerCells = headerCells\r\n        this.bodyRows    = bodyRows\r\n    }\r\n\r\n    #tableHeaderCell = content => el(\"th\", content)\r\n    #tableBodyCell   = content => el(\"td\", parseEntry(content))\r\n    #tableHeaderRow  = row => el(\"tr\", row.map(this.#tableHeaderCell))\r\n    #tableBodyRow    = row => el(\"tr\", row.map(this.#tableBodyCell))\r\n\r\n    toHTML() {\r\n        const tableHeader = el(\r\n            \"thead\",\r\n            this.#tableHeaderRow(this.headerCells)\r\n        )\r\n        const tableBody = el(\r\n            \"tbody\",\r\n            this.bodyRows\r\n                .map(this.#tableBodyRow)\r\n        )\r\n        return el(\"div\", el(\"table\", [tableHeader, tableBody]), {\r\n            \"class\": \"table\"\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"| \")\r\n}\r\n\r\n// --- --- --- --- -\r\n// media nodes start\r\n// --- --- --- --- -\r\n\r\nclass MediaNode {\r\n    source = \"\"\r\n    description = \"\"    \r\n    constructor(mdText) {\r\n        mdText = mdText.substr(2)\r\n        this.description = getInterval(mdText, \"]\")\r\n        mdText = mdText.substr(this.description.length + 2)\r\n        this.source = getInterval(mdText, \")\")\r\n    }\r\n\r\n    static containerGenerator(content) {\r\n        return el(\"div\", content, {\r\n            \"class\": \"media-container\"\r\n        })\r\n    }\r\n\r\n    static patternGenerator(identifierSign) {\r\n        return (source) =>\r\n            source.startsWith(identifierSign + \"[\") && source.endsWith(\")\")\r\n    }\r\n\r\n    static replaceContentGenerator(href, description) {\r\n        const downloadEl = el(\"a\", languageSelector(\"从这里下载！\", \"Download Here!\"), { href })\r\n        const replaceContent = `${description}<br>${downloadEl}`\r\n        return replaceContent\r\n    }\r\n\r\n    static srcUrlResolver(rawUrl) {\r\n        let actualUrl\r\n        if (rawUrl.startsWith(\"http\") || rawUrl.startsWith(\"data\")) {\r\n            actualUrl = rawUrl\r\n        } else {\r\n            const hash = location.hash.slice(1)\r\n            // get the parent directory path\r\n            const currentPath = hash.split(\"/\").slice(0, -1).join(\"/\")\r\n            actualUrl = currentPath + \"/\" + rawUrl\r\n        }\r\n        return actualUrl\r\n    }\r\n}\r\n\r\nexport class Image extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"!\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const imageEl = el(\"img\", \"\", {\r\n            src: actualUrl,\r\n            alt: this.description,\r\n            loading: \"lazy\",\r\n            tabindex: 0,\r\n        })\r\n        imageEl.onclick = e =>\r\n            window.open(e.target.src)\r\n        imageEl.onerror = e => {\r\n            const target = e.target\r\n            target.onclick = null\r\n            target.title = this.description\r\n            target.classList.add(\"load-error\")\r\n        }\r\n        return MediaNode.containerGenerator(imageEl)\r\n    }\r\n}\r\n\r\nexport class Audio extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\":\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const audioEl = el(\"audio\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: true,\r\n        })\r\n        return MediaNode.containerGenerator(audioEl)\r\n    }\r\n}\r\n\r\nexport class Video extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"?\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const videoEl = el(\"video\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: \"true\",\r\n        })\r\n        return MediaNode.containerGenerator(videoEl)\r\n    }\r\n}\r\n\r\nexport const isIframePattern = (source) =>\r\n    MediaNode.patternGenerator(\"@\")(source)\r\n    || source.startsWith(\"@@@\")\r\n\r\nexport class Iframe extends MediaNode {\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            src: actualUrl,\r\n            title: this.description,\r\n            sandbox: \"allow-scripts\",\r\n            loading: \"lazy\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// media nodes end\r\n// --- --- --- ---\r\n\r\n// --- --- --- --- -\r\n// block nodes start\r\n// --- --- --- --- -\r\n\r\nexport class CodeBlock {\r\n    constructor(content, lang) {\r\n        this.lang = lang\r\n        this.content = content\r\n    }\r\n    toHTML() {\r\n        const isPlaintext = [\"plaintext\", \"text\", \"\"].includes(this.lang)\r\n        if (!isPlaintext) {\r\n            globalThis.__LanguageList__.add(this.lang)\r\n        }\r\n\r\n        let langName, langClass\r\n        if (isPlaintext) {\r\n            langClass = \"nohighlight\"\r\n            langName  = \"PLAINTEXT\"\r\n        } else {\r\n            langClass = `language-${this.lang}`\r\n            langName  = this.lang.toUpperCase()\r\n        }\r\n\r\n        const codeEl = el(\"code\", this.content, {\r\n            \"class\": langClass,\r\n            tabindex: 0\r\n        })\r\n        return el(\"pre\", codeEl, {\r\n            \"class\": \"code-block\",\r\n            \"data-language\": langName\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"```\")\r\n}\r\n\r\nexport class DetailsBlock {\r\n    summary = \"\"\r\n    content = \"\"\r\n\r\n    constructor(content, summary) {   \r\n        this.summary = summary\r\n        this.content = content\r\n    }\r\n    toHTML() {\r\n        const summaryEl = el(\"summary\", parseEntry(this.summary))\r\n        const detailsEl = el(\"details\", summaryEl)\r\n\r\n        const innerNodes = this.content\r\n            .map(node => node.toHTML())\r\n        const childrenEl = el(\"div\", el(\"div\", innerNodes, {\r\n            \"class\": \"details-children\"\r\n        }), {\r\n            \"class\": \"details-children-container\"\r\n        })\r\n        return el(\"div\", [detailsEl, childrenEl], {\r\n            \"class\": \"details\"\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\">>>\")\r\n}\r\n\r\nexport class FormulaBlock {\r\n    content = \"\"\r\n    description = \"\"\r\n\r\n    constructor(content, description) {\r\n        this.content = content\r\n        this.description = description\r\n    }\r\n    toHTML() {\r\n        globalThis.__ContainsFormula__ = true\r\n        return el(\"div\", this.content, {\r\n            \"class\": \"math\",\r\n            title: this.description,\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\"$$$\")\r\n}\r\n\r\nexport class IframeBlock {\r\n    // injected html codes, used to auto darkmode\r\n    // and send height message\r\n    static #injectedCodes = id => `\\\r\n<style>\r\nbody{transition: .3s .15s}\r\nbody.light{color:#333;background:#fff}\r\nbody.dark{color:#f7f7f7;background:#252525}</style>\r\n<script>\r\nconst rootEl = document.documentElement\r\nfunction postHeight() {\r\n    const parent = window.parent\r\n    const height = parseFloat(getComputedStyle(rootEl).height)\r\n    parent.postMessage({\r\n        height,\r\n        id: \"${id}\"\r\n    }, \"*\")\r\n}\r\nwindow.addEventListener(\"load\", postHeight)\r\nwindow.addEventListener(\"message\", e => {\r\nconst { fontSize, theme } = e.data\r\nif (fontSize) {\r\n    rootEl.style.fontSize = fontSize\r\n    postHeight()\r\n}\r\nif (theme) {\r\n    document.body.classList = theme\r\n}\r\n})\r\n</script>`\r\n\r\n    constructor(content, description) {\r\n        globalThis.__IframeCounter__ += 1\r\n        this.id = \"iframe_\" + globalThis.__IframeCounter__\r\n        this.description = description\r\n        this.content = content + IframeBlock.#injectedCodes(this.id)\r\n    }\r\n\r\n    toHTML() {\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            id: this.id,\r\n            title: this.description,\r\n            srcdoc: this.content,\r\n            sandbox: \"allow-scripts\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl)\r\n    }\r\n}\r\n\r\n// types of chart blocks\r\n\r\nclass EchartsChartType {\r\n    constructor(content) {\r\n        const options = new Function(\r\n            \"let option;\"\r\n            + content\r\n            + \";return option\"\r\n        )()\r\n        this.chartOptions = options\r\n        globalThis.__ChartTypeList__.add(\"echarts\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"echarts-container\",\r\n        })\r\n        chartEl.__ChartOptions__ = this.chartOptions\r\n        return chartEl\r\n    }\r\n}\r\nclass FlowChartType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"flow-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"flowchart-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass SequenceChartType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"sequence-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"sequencechart-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass GanttChartType {\r\n    constructor(content) {\r\n        this.content = new Function(`const tasks = [${content}]; return tasks`)()\r\n        globalThis.__ChartTypeList__.add(\"gantt-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"ganttchart-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass RailroadChartType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"railroad-chart\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"railroad-container\"\r\n        })\r\n        chartEl.__ChartContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass QRCodeType {\r\n    constructor(content) {\r\n        this.content = content\r\n        globalThis.__ChartTypeList__.add(\"qrcode\")\r\n    }\r\n    toHTML() {\r\n        const chartEl = el(\"div\", \"\", {\r\n            \"class\": \"qrcode-container\"\r\n        })\r\n        chartEl.__QRCodeContent__ = this.content\r\n        return chartEl\r\n    }\r\n}\r\nclass UnknownChartType {\r\n    constructor(errMsg) {\r\n        this.content = errMsg\r\n    }\r\n    toHTML() {\r\n        return el(\"span\", this.content)\r\n    }\r\n}\r\n\r\nexport class ChartBlock {\r\n    static pattern = source =>\r\n        source.startsWith(\"!!!\")\r\n    \r\n    #type = null\r\n\r\n    constructor(content, type) {\r\n        switch (type) {\r\n            case \"\": case \"echarts\":\r\n                this.#type = new EchartsChartType(content)\r\n                break\r\n            case \"flow\":       case \"flowchart\":\r\n            case \"flow chart\": case \"flow-chart\":\r\n                this.#type = new FlowChartType(content)\r\n                break\r\n            case \"sequence\":      case \"sequencechart\":\r\n            case \"sequence char\": case \"sequence-chart\":\r\n                this.#type = new SequenceChartType(content)\r\n                break\r\n            case \"gantt\":       case \"ganttchart\":\r\n            case \"gantt chart\": case \"gantt-chart\":\r\n                this.#type = new GanttChartType(content)\r\n                break\r\n            case \"rail\": case \"railroad\": case \"railroadchart\":\r\n            case \"railroad chart\":        case \"railroad-chart\":\r\n                this.#type = new RailroadChartType(content)\r\n                break\r\n            case \"qrcode\": case \"qr-code\": case \"qr code\":\r\n                this.#type = new QRCodeType(content)\r\n                break\r\n            default:\r\n                const errMsg = \"Unknown chart type: \" + type\r\n                console.error(errMsg)\r\n                this.#type = new UnknownChartType(errMsg)\r\n        }\r\n    }\r\n    toHTML() {\r\n        const chartEl = this.#type.toHTML()\r\n        return MediaNode.containerGenerator(chartEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// block nodes end\r\n// --- --- --- ---\r\n","export default function(line) {\r\n    let indentCount = 0\r\n    let spaceCount = 0\r\n\r\n    for (const ch of line) {\r\n        if (ch.match(/[^\\s\\t]/)) {\r\n            break\r\n        }\r\n\r\n        if (ch === \"\\t\") {\r\n            indentCount += 1\r\n            continue\r\n        }\r\n        if (ch === \" \") {\r\n            spaceCount += 1\r\n        }\r\n        if (spaceCount === 2) {\r\n            spaceCount = 0\r\n            indentCount += 1\r\n        }\r\n    }\r\n    return indentCount\r\n}\r\n","import { List } from \"../node.js\"\r\nimport getIndent from \"../utils/getIndent.js\"\r\n\r\nexport default function listResolver(currentLine, lines) {\r\n    const currentIndent = getIndent(currentLine)\r\n    const currentNode = new List(currentLine)\r\n\r\n    while (lines.length && List.isListPattern(lines[0])) {\r\n        const nextLine = lines.shift()\r\n        const nextIndent = getIndent(nextLine)\r\n        const isNextOrdered = List.orderedPattern(nextLine)\r\n\r\n        if (nextIndent > currentIndent) {\r\n            currentNode.children.push(listResolver(nextLine, lines))\r\n        } else if (nextIndent === currentIndent && isNextOrdered === currentNode.isOrdered) {\r\n            currentNode.children.push(List.getContent(nextLine, isNextOrdered))\r\n        } else {\r\n            lines.unshift(nextLine)\r\n            break\r\n        }\r\n    }\r\n    return currentNode\r\n}","import mdResolver from \"../index.js\"\r\nimport { Quote } from \"../node.js\"\r\n\r\nexport default function(firstLine, lines) {\r\n    let quotedContent = firstLine.slice(2) + \"\\n\"\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Quote.pattern(l)) {\r\n            quotedContent += l.slice(2) + \"\\n\"\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n    const children = mdResolver(quotedContent)\r\n    const node = new Quote(children)\r\n    return node\r\n}\r\n","import { Table } from \"../node.js\"\r\n\r\n// input: \"| content | content |\"\"\r\n// output: [\"content\",\"content\"]\r\nfunction tableLineConverter(tableLine) {\r\n    const splited = tableLine.split(\"|\")\r\n    const result = splited\r\n        .filter(item => item.length > 0)\r\n        .map(item => item.trim())\r\n    return result\r\n}\r\n\r\nexport default function(firstLine, lines) {\r\n    const headerText = firstLine\r\n    const contentLines = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Table.pattern(l)) {\r\n            contentLines.push(l)\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n\r\n    const headerCells = tableLineConverter(headerText)\r\n    const contentRows = contentLines.map(tableLineConverter)\r\n    const tableNode = new Table(headerCells, contentRows)\r\n    return tableNode\r\n}\r\n","import mdResolver from \"../index.js\"\r\nimport { ChartBlock, CodeBlock, DetailsBlock, FormulaBlock, Iframe, IframeBlock } from \"../node.js\"\r\n\r\nexport function blockResolverGenerator(endSign, targetClass) {\r\n    return function(firstLine, lines) {\r\n        const description = firstLine.slice(3)\r\n\r\n        let content = \"\"\r\n        while (lines.length) {\r\n            const l = lines.shift()\r\n\r\n            if (l === endSign) {\r\n                break\r\n            }\r\n\r\n            content += l + \"\\n\"\r\n        }\r\n        return new targetClass(content, description)\r\n    }\r\n}\r\n\r\nexport const codeResolver    = blockResolverGenerator(\"```\", CodeBlock)\r\nexport const chartResolver   = blockResolverGenerator(\"!!!\", ChartBlock)\r\nexport const formulaResolver = blockResolverGenerator(\"$$$\", FormulaBlock)\r\nexport function detailsResolver(firstLine, lines) {\r\n    const resolver = blockResolverGenerator(\">>>\", DetailsBlock)\r\n    const node = resolver(firstLine, lines)\r\n    node.content = mdResolver(node.content)\r\n    return node\r\n}\r\nexport function iframeResolver(firstLine, lines) {\r\n    const resolver = blockResolverGenerator(\"@@@\", IframeBlock)\r\n\r\n    if (!firstLine.startsWith(\"@@@\")) {\r\n        // link to out resource\r\n        return new Iframe(firstLine)\r\n    }\r\n    return resolver(firstLine, lines)\r\n}\r\n","import {\r\n    Headline, Quote, Divider,\r\n    List, Para, Table,\r\n    Image, Audio, Video,\r\n    FormulaBlock, CodeBlock,\r\n    isIframePattern,\r\n    DetailsBlock,\r\n    ChartBlock\r\n} from \"./node.js\"\r\nimport {\r\n    listResolver, quoteResolver, tableResolver,\r\n    codeResolver, formulaResolver, chartResolver,\r\n    iframeResolver, detailsResolver,\r\n} from \"./resolvers/index.js\"\r\nimport getLines from \"./utils/getLines.js\"\r\n\r\nexport default function mdResolver(source) {\r\n    const lines = getLines(source)\r\n    const nodes = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (!l.length) {\r\n            // skip empty line\r\n            continue\r\n        }\r\n\r\n        if (Headline.pattern(l)) {\r\n            nodes.push(new Headline(l))\r\n        } else\r\n        if (Divider.pattern(l)) {\r\n            nodes.push(new Divider)\r\n        } else\r\n        if (Quote.pattern(l)) {\r\n            nodes.push(quoteResolver(l, lines))\r\n        } else\r\n        if (List.isListPattern(l)) {\r\n            nodes.push(listResolver(l, lines))\r\n        } else\r\n        if (Table.pattern(l)) {\r\n            nodes.push(tableResolver(l, lines))\r\n        } else\r\n        if (Image.pattern(l)) {\r\n            nodes.push(new Image(l))\r\n        } else\r\n        if (Audio.pattern(l)) {\r\n            nodes.push(new Audio(l))\r\n        } else\r\n        if (Video.pattern(l)) {\r\n            nodes.push(new Video(l))\r\n        } else\r\n        if (DetailsBlock.pattern(l)) {\r\n            nodes.push(detailsResolver(l, lines))\r\n        } else\r\n        if (FormulaBlock.pattern(l)) {\r\n            nodes.push(formulaResolver(l, lines))\r\n        } else\r\n        if (CodeBlock.pattern(l)) {\r\n            nodes.push(codeResolver(l, lines))\r\n        } else\r\n        if (ChartBlock.pattern(l)) {\r\n            nodes.push(chartResolver(l, lines))\r\n        } else\r\n        if (isIframePattern(l)) {\r\n            nodes.push(iframeResolver(l, lines))\r\n        } else {\r\n            nodes.push(new Para(l))\r\n        }\r\n    }\r\n    return nodes\r\n}","export default function(source) {\r\n    if (source.indexOf(\"\\r\") != -1) {\r\n        return source.split(\"\\r\\n\")\r\n    } else {\r\n        return source.split(\"\\n\")\r\n    }\r\n}","export default function(el) {\r\n    return function(e) {\r\n        // when Enter key or Space key\r\n        if (e.key === \"Enter\" || e.key === \" \") {\r\n            el.click()\r\n        }\r\n    }\r\n}\r\n","export function scrollToPos(pos) {\r\n    window.scroll({\r\n        top: pos,\r\n        behavior: \"smooth\",\r\n    })\r\n}\r\n\r\n// return to the position of specific element\r\nexport function scrollToEl(el, offset) {\r\n    const scrollTargetPos = el.offsetTop\r\n    const scrollOffset = -offset\r\n    scrollToPos(scrollTargetPos + scrollOffset)\r\n}\r\n\r\n// return to the document top\r\nexport function scrollToTop() {\r\n    scrollToPos(0)\r\n}\r\n","const embeddedIframes = () => document.querySelectorAll(\"iframe[srcdoc]\")\r\n\r\nexport function setIframeRem(fontSize) {\r\n    embeddedIframes().forEach(el =>\r\n        el.contentWindow.postMessage({ fontSize }, \"*\"))\r\n}\r\n\r\nexport async function allIframeLoaded() {\r\n    const loadEvents = Array.from(embeddedIframes()).map(el => {\r\n        return new Promise((resolve, _) => el.onload = resolve)\r\n    })\r\n    await Promise.all(loadEvents)\r\n}\r\n\r\nexport function setIframeTheme() {\r\n    const isDarkMode      = document.body.classList.contains(\"dark\")\r\n    const theme           = isDarkMode ? \"dark\" : \"light\"\r\n    embeddedIframes().forEach(el =>\r\n        el.contentWindow.postMessage({ theme }, \"*\"))\r\n}\r\n","import highlightRender from \"./importers/highlight.js\"\r\nimport katexRender from \"./importers/katex.js\"\r\nimport chartRender from \"./importers/charts/index.js\"\r\n\r\nimport mdResolver from \"../utils/markdown/index.js\"\r\nimport keydownEvent from \"../utils/dom/keydownEvent.js\"\r\nimport eventbus from \"../utils/eventbus/inst.js\"\r\nimport config from \"../../build.config.js\"\r\nimport { Headline } from \"../utils/markdown/node.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\nimport { scrollToPos } from \"../utils/dom/scrollControl.js\"\r\nimport { allIframeLoaded, setIframeTheme } from \"./iframeController.js\"\r\nimport { parseEntry } from \"../utils/markdown/inline.js\"\r\n\r\nconst emptyArticlePlaceHolder = languageSelector(\"空文章\", \"Empty Article\")\r\n\r\nfunction getHeadlines(structure) {\r\n    return structure\r\n        .filter(node => node instanceof Headline)\r\n        .map((node, index) => {\r\n            const id = node.id = \"headline-\" + index\r\n            const content = parseEntry(node.content)\r\n            return {\r\n                id, content,\r\n                level: node.tagName,\r\n            }\r\n        })\r\n}\r\n\r\nexport default function articleRender(articleEl, mdText) {\r\n    // language names to import for `highlight.js`\r\n    globalThis.__LanguageList__ = new Set()\r\n    // to deside which chart library to import\r\n    globalThis.__ChartTypeList__ = new Set()\r\n    // to deside whether to import `katex`\r\n    globalThis.__ContainsFormula__ = false\r\n    // used to dynamic generate iframe id\r\n    globalThis.__IframeCounter__ = 0\r\n\r\n    const structure = mdResolver(mdText)\r\n    if (config.enableCatalog) {\r\n        const headlineItems = getHeadlines(structure)\r\n        eventbus.emit(\"article-rendered\", headlineItems)\r\n    }\r\n\r\n    let resultNodes = structure.map(node => node.toHTML())\r\n    if (!resultNodes.length) {\r\n        resultNodes = el(\"h1\", emptyArticlePlaceHolder)\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    const fragment = document.createDocumentFragment()\r\n    resultNodes.forEach(el => fragment.appendChild(el))\r\n    articleEl.innerHTML = \"\"\r\n    articleEl.appendChild(fragment)\r\n\r\n    // set iframes' theme after all loaded\r\n    allIframeLoaded().then(setIframeTheme)\r\n\r\n    articleEl.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n\r\n    Promise.all([\r\n        highlightRender(globalThis.__LanguageList__),\r\n        katexRender(globalThis.__ContainsFormula__),\r\n        chartRender(globalThis.__ChartTypeList__),\r\n    ]).then(() => {\r\n        globalThis.__LanguageList__    = null\r\n        globalThis.__ContainsFormula__ = false\r\n        globalThis.__ChartTypeList__   = null\r\n\r\n        // scroll to the position last leaved\r\n        const lastLeavePage = sessionStorage.getItem(\"last-leave-page\")\r\n        const lastLeavePos  = sessionStorage.getItem(\"last-leave-position\") || 0\r\n        sessionStorage.removeItem(\"last-leave-page\")\r\n        sessionStorage.removeItem(\"last-leave-position\")\r\n\r\n        if (window.scrollY > 0) {\r\n            // when is scrolled, skip position restoring\r\n            return\r\n        }\r\n        if (location.hash !== lastLeavePage) {\r\n            return\r\n        }\r\n        scrollToPos(Number.parseInt(lastLeavePos))\r\n    })\r\n}\r\n","import articleRender from \"./articleRenderer.js\"\r\nimport el from \"../utils/dom/el.js\"\r\nimport keydownEvent from \"../utils/dom/keydownEvent.js\"\r\nimport { scrollToTop } from \"../utils/dom/scrollControl.js\"\r\n\r\nexport function newestItemRenderer(item) {\r\n    const createDate = new Date(item.timestamp)\r\n    const formatedDate = new Intl.DateTimeFormat().format(createDate)\r\n    const dateEl  = el(\"code\", formatedDate)\r\n    const titleEl = el(\"span\", item.title, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    return el(\"li\",\r\n        [dateEl, el(\"text\", \": \"), titleEl],\r\n        {\r\n            tabindex: 0,\r\n            \"class\": \"underline-through\",\r\n            \"data-target-blog\": item.link,\r\n        }\r\n    )\r\n}\r\nexport function directoryItemRenderer(item) {\r\n    const contentEl = el(\"span\", item, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    return el(\"li\", contentEl, {\r\n        \"class\": \"underline-through\",\r\n        tabindex: 0,\r\n    })\r\n}\r\n\r\nconst mainEl           = document.querySelector(\"main\")\r\nconst articleEl        = document.querySelector(\"article\")\r\nconst articleContainer = document.querySelector(\"#article-container\")\r\nconst articleList      = mainEl.querySelector(\"#article-list\")\r\nconst dirDescriptionEl = mainEl.querySelector(\"#directory-description\")\r\nconst pagingComponent  = mainEl.querySelector(\"paging-view\")\r\n\r\nexport default function indexRender(indexing, itemResolver) {\r\n    const {current, total} = indexing\r\n    pagingComponent.setPage(current, total)\r\n\r\n    // --- --- --- --- --- ---\r\n    \r\n    // reset directory description\r\n    dirDescriptionEl.innerHTML = \"\"\r\n    if (\"directoryDescription\" in indexing) {\r\n        articleRender(dirDescriptionEl, indexing.directoryDescription)\r\n    }\r\n\r\n    // reset articleList content\r\n    const fragment = document.createDocumentFragment()\r\n    indexing.content\r\n        .map(itemResolver)\r\n        .forEach(el => fragment.appendChild(el))\r\n    articleList.innerHTML = \"\"\r\n    articleList.appendChild(fragment)\r\n\r\n    // set keyboard event\r\n    articleList.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    articleEl.innerHTML = \"\"\r\n    mainEl.classList.remove(\"hidden\")\r\n    scrollToTop()\r\n}\r\n","import pageController from \"../components/paging.js\"\r\nimport { fetchJSON, fetchMD } from \"./fetchResources.js\"\r\nimport articleRender from \"./articleRenderer.js\"\r\nimport indexRender, { newestItemRenderer, directoryItemRenderer } from \"./indexRenderer.js\"\r\nimport { scrollToTop } from \"../utils/dom/scrollControl.js\"\r\n\r\nconst mainEl = document.querySelector(\"main\")\r\nconst articleEl = document.querySelector(\"article\")\r\nconst indexDirPath = \"./.index/\"\r\n\r\nexport async function hashChangeEvent(e) {\r\n    if (!location.hash) {\r\n        pathManager.homepage()\r\n        return\r\n    }\r\n    const hash = location.hash.slice(1)\r\n    mainEl.classList.add(\"disabled\")\r\n\r\n    if (pathManager.isIn.newestPage()) {\r\n        // open newest page\r\n        const indexPath = indexDirPath\r\n            + \"newest_\"\r\n            + pageController.current()\r\n        const newestIndex = await fetchJSON(indexPath)\r\n        if (!newestIndex) return\r\n        indexRender(newestIndex, newestItemRenderer)\r\n    } else\r\n    if (pathManager.isIn.directory()) {\r\n        // open directory\r\n        const splited = hash.split(\"/\").slice(0, -1)\r\n        const indexFilePath = indexDirPath\r\n            + splited.join(\"+\") + \"_\"\r\n            + pageController.current()\r\n        const index = await fetchJSON(indexFilePath)\r\n        if (!index) return\r\n        indexRender(index, directoryItemRenderer)\r\n    } else\r\n    if (pathManager.isIn.article()) {\r\n        // open article\r\n        articleEl.innerHTML = \"\"\r\n        mainEl.classList.add(\"hidden\")\r\n        const articleContent = await fetchMD(\"./\" + hash)\r\n        if (!articleContent) return\r\n        articleRender(articleEl, articleContent)\r\n    } else {\r\n        pathManager.homepage()\r\n    }\r\n\r\n    mainEl.setAttribute(\"data-is-root\", hash === \"static/\")\r\n    mainEl.classList.remove(\"disabled\")\r\n\r\n    const getHash = url => new URL(url).hash\r\n    if (e instanceof HashChangeEvent\r\n        && pathManager.isIn.directory(getHash(e.oldURL))\r\n        && pathManager.isIn.article(getHash(e.newURL))) {\r\n        // when enters an article from directory\r\n        scrollToTop()\r\n    }\r\n}\r\n\r\nwindow.addEventListener(\"hashchange\", hashChangeEvent)\r\nwindow.addEventListener(\"load\", hashChangeEvent)\r\n\r\nconst homepagePath = \"static/\"\r\nconst newestPath = \"newest/\"\r\nconst pathManager = {\r\n    homepage() {\r\n        location.hash = homepagePath\r\n    },\r\n\r\n    open(name) {\r\n        location.hash += name\r\n    },\r\n    jumpTo(target) {\r\n        location.hash = target\r\n    },\r\n    parent() {\r\n        if (this.isIn.root() || this.isIn.newestPage()) {\r\n            return homepagePath\r\n        }\r\n        const splited = location.hash.slice(1).split(\"/\")\r\n        if (this.isIn.directory()) {\r\n            return splited.slice(0, -2).join(\"/\") + \"/\"\r\n        }\r\n        if (this.isIn.article()) {\r\n            return splited.slice(0, -1).join(\"/\") + \"/\"\r\n        }\r\n        throw new Error(\"Unexpected hash: \" + location.hash)\r\n    },\r\n    isIn: {\r\n        root() {\r\n            return location.hash === \"#\" + homepagePath\r\n        },\r\n        newestPage() {\r\n            return location.hash === \"#\" + newestPath\r\n        },\r\n        directory(test) {\r\n            const testTarget = test || location.hash\r\n            return testTarget.startsWith(\"#static\")\r\n                && testTarget.endsWith(\"/\")\r\n        },\r\n        article(test) {\r\n            const testTarget = test || location.hash\r\n            return testTarget.startsWith(\"#static\")\r\n                && testTarget.endsWith(\".md\")\r\n        }\r\n    }\r\n}\r\nexport default pathManager\r\n","import { hashChangeEvent } from \"../scripts/pathManager.js\"\r\nimport el from \"../utils/dom/el.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\n\r\nclass PageController {\r\n    #pageList = [1]\r\n\r\n    current = () => this.#pageList[this.length() - 1]\r\n    next    = () => this.#pageList[this.length() - 1] += 1\r\n    prev    = () => this.#pageList[this.length() - 1] -= 1\r\n    jumpTo  = targetPage => this.#pageList[this.length() - 1] = Number(targetPage)\r\n    length  = () => this.#pageList.length\r\n\r\n    back() {\r\n        // called when \"popstate\" event emited\r\n        this.#pageList.pop()\r\n        if (!this.#pageList.length) {\r\n            this.#pageList.push(1)\r\n        }\r\n    }\r\n    open() {\r\n        // called when enter directory\r\n        this.#pageList.push(1)\r\n    }\r\n}\r\nconst pageController = new PageController()\r\nexport default pageController\r\n\r\n// --- --- --- --- --- ---\r\n\r\nconst btn = content => el(\"button\",\r\n    el(\"span\", content, {\r\n        \"class\": \"underline-target\"\r\n    }), {\r\n    \"class\": \"icon-btn underline-side\"\r\n})\r\n\r\nclass PagingView extends HTMLElement {\r\n    #elements = {}\r\n\r\n    constructor() {\r\n        super()\r\n\r\n        this.#elements.input = el(\"input\", \"1\", {\r\n            type: \"number\",\r\n            min: 1,\r\n            max: 1,\r\n        })\r\n        this.#elements.maxPage = el(\"span\", \"1\")\r\n        const prevBtn = this.#elements.prevBtn = btn(languageSelector(\"上一页\", \"Prev\"))\r\n        const nextBtn = this.#elements.nextBtn = btn(languageSelector(\"下一页\", \"Next\"))\r\n        prevBtn.id = \"prev-btn\"; prevBtn.classList.add(\"left\")\r\n        nextBtn.id = \"next-btn\"; nextBtn.classList.add(\"right\")\r\n\r\n        const labelEl = el(\"label\", [\r\n            this.#elements.input,\r\n            el(\"text\", \"/\"),\r\n            this.#elements.maxPage,\r\n        ])\r\n        this.#appendEvent()\r\n        for (const el of [prevBtn, labelEl, nextBtn]) {\r\n            this.appendChild(el)\r\n        }\r\n    }\r\n    #appendEvent() {\r\n        this.#elements.input.addEventListener(\"keydown\", e => {\r\n            if (e.key !== \"Enter\") {\r\n                return\r\n            }\r\n            const targetPageStr = e.target.value\r\n            if (!/^\\d+$/.test(targetPageStr)) {\r\n                e.target.value = 1\r\n                return\r\n            }\r\n            const targetPage = Number(targetPageStr)\r\n            if (!(targetPage > 0 && targetPage <= this.#elements.input.max)) {\r\n                e.target.value = 1\r\n                return\r\n            }\r\n            pageController.jumpTo(targetPage)\r\n            hashChangeEvent()\r\n        })\r\n        this.#elements.prevBtn.addEventListener(\"click\", () => {\r\n            if (pageController.current() > 0) {\r\n                pageController.prev()\r\n                hashChangeEvent()\r\n            }\r\n        })\r\n        this.#elements.nextBtn.addEventListener(\"click\", () => {\r\n            if (pageController.current() < this.#elements.input.max) {\r\n                pageController.next()\r\n                hashChangeEvent()\r\n            }\r\n        })\r\n    }\r\n    setPage(current, total) {\r\n        let isFirstPage = false\r\n        let isLastPage  = false\r\n        let isOnlyPage  = false\r\n        if (total === 1) {\r\n            isOnlyPage = true\r\n        } else {\r\n            if (current === 1) {\r\n                isFirstPage = true\r\n            }\r\n            if (current === total) {\r\n                isLastPage = true\r\n            }\r\n        }\r\n        this.#elements.prevBtn.disabled = isOnlyPage || isFirstPage\r\n        this.#elements.nextBtn.disabled = isOnlyPage || isLastPage\r\n        this.#elements.maxPage.textContent = total\r\n        this.#elements.input.value = current\r\n        this.#elements.input.max   = total\r\n        this.classList.toggle(\"hidden\", isOnlyPage)\r\n    }\r\n}\r\ncustomElements.define(\"paging-view\", PagingView)\r\n","import pageController from \"../components/paging.js\"\r\nimport keydownEvent from \"../utils/dom/keydownEvent.js\"\r\nimport pathManager from \"./pathManager.js\"\r\n\r\nconst mainEl       = document.querySelector(\"main\")\r\nconst newest       = mainEl.querySelector(\"#newest\")\r\nconst parentDirBtn = mainEl.querySelector(\"#previous-dir li\")\r\nconst articleList  = mainEl.querySelector(\"#article-list\")\r\n\r\nif (newest !== null) {\r\n    const targetEl = newest.children[0]\r\n    targetEl.onkeydown = keydownEvent(targetEl)\r\n}\r\n\r\nparentDirBtn.onkeydown = keydownEvent(parentDirBtn)\r\nparentDirBtn.addEventListener(\"click\", () => {\r\n    pageController.back()\r\n    pathManager.jumpTo(pathManager.parent())\r\n})\r\narticleList.addEventListener(\"click\", e => {\r\n    const target = e.target\r\n\r\n    if (target === articleList) {\r\n        // when click on the `articleList` itself\r\n        // ignore this event.\r\n        return\r\n    }\r\n\r\n    if (!target.getAttribute(\"data-target-blog\")) {\r\n        if (target.innerText.endsWith(\"/\")) {\r\n            // open directory\r\n            pageController.open()\r\n        }\r\n        pathManager.open(target.innerText)\r\n    } else {\r\n        // in `newest` page\r\n        pageController.open()\r\n        pathManager.jumpTo(target.getAttribute(\"data-target-blog\"))\r\n    }\r\n})\r\n","import \"./styles/style.css\"\r\nimport \"./styles/components/skeleton.css\"\r\n\r\nimport \"./scripts/mainManager.js\"\r\nimport config from \"../build.config.js\"\r\nimport pageController from \"./components/paging.js\"\r\nimport pathManager from \"./scripts/pathManager\"\r\nimport { setIframeTheme } from \"./scripts/iframeController.js\"\r\nimport importStyle from \"./scripts/importers/style.js\"\r\nimport keydownEvent from \"./utils/dom/keydownEvent.js\"\r\nimport eventbus from \"./utils/eventbus/inst.js\"\r\n\r\nimportStyle(\"dist/chunks/skeleton.min.css\")\r\n\r\n// import optional components\r\nif (config.enableFab) {\r\n    import(\"./components/fab.js\")\r\n}\r\nif (config.enableSearch) {\r\n    import(\"./components/searchBox.js\")\r\n}\r\nif (config.enableCatalog) {\r\n    function passEvent() {\r\n        if (isToShow) {\r\n            eventbus.emit(\"article-rendered\", items)\r\n        }\r\n    }\r\n    let isLoaded = false\r\n    let isToShow = false\r\n    let items = null\r\n    import(\"./components/catalog.js\")\r\n        .then(() => isLoaded = true)\r\n        .then(passEvent)\r\n    \r\n    eventbus.on(\"article-rendered\", _items => {\r\n        if (!isLoaded) {\r\n            isToShow = true\r\n            items = _items\r\n        }\r\n    })\r\n}\r\n\r\n// set theme switcher button event\r\nconst searchBtn = document.getElementById(\"search-btn\")\r\nconst lightBtn  = document.getElementById(\"light-btn\")\r\nconst darkBtn   = document.getElementById(\"dark-btn\")\r\nsearchBtn.onclick  = () => eventbus.emit(\"searchbox-show\")\r\nlightBtn.onkeydown = keydownEvent(lightBtn)\r\ndarkBtn.onkeydown  = keydownEvent(darkBtn)\r\n\r\n// --- --- --- --- --- ---\r\n\r\nwindow.addEventListener(\"popstate\", () => {\r\n    if (location.hash.endsWith(\"/\")) {\r\n        // in a directory\r\n        pageController.back()\r\n    }\r\n})\r\n\r\nwindow.addEventListener(\"beforeunload\", e => {\r\n    if (!pathManager.isIn.article()) {\r\n        return\r\n    }\r\n    // when leave an article remember current scroll position\r\n    sessionStorage.setItem(\"last-leave-page\", location.hash)\r\n    sessionStorage.setItem(\"last-leave-position\", window.scrollY)\r\n})\r\n\r\n// set embedded iframe theme\r\nconst darkmodeObserver = new MutationObserver(setIframeTheme)\r\ndarkmodeObserver.observe(document.body, {\r\n    attributes: true,\r\n    attributeFilter: [\"class\"]\r\n})\r\n\r\n// set embedded iframe height\r\nwindow.addEventListener(\"message\", e => {\r\n    if (e.origin != \"null\") {\r\n        return\r\n    }\r\n    const { id, height } = e.data\r\n    const targetIframeEl = document.getElementById(id)\r\n    targetIframeEl.style.height = height + \"px\"\r\n})\r\n\r\nif (\"serviceWorker\" in navigator) {\r\n    // if support service worker, register\r\n    navigator.serviceWorker\r\n        .register(\"./sw.js\")\r\n        .catch(function(error) {\r\n            // registration failed\r\n            console.error(\"Registration failed with \" + error);\r\n        })\r\n}\r\n"],"names":["controller","async","fetchJSON","path","abort","AbortController","fetch","signal","then","json","res","catch","err","console","log","error","currentLang","config","language","langList","languageSelector","lang","index","langName","Object","entries","selections","warn","languageSelectorCreator","UnOverridedError","Error","constructor","name","super","this","message","DynamicImporter","static","_module","_targetElList","importModule","props","beforeRender","loadCondition","renderItem","el","renderAll","renderErrResolver","loadErrResolver","forEach","textContent","loadErrMsg","renderErrMsg","render","importStyle","Promise","resolve","reject","linkEl","document","createElement","rel","href","head","appendChild","onload","onerror","inst","querySelectorAll","importLangDefs","languageList","langDefImporters","filter","getLanguage","map","__variableDynamicImportRuntime0__","toLowerCase","all","langDefs","defModule","def","default","registerLanguage","size","highlightElement","Set","Array","from","import","highlightRender","bind","katexOptions","isContainsFormula","texString","ParseError","innerHTML","replace","katexRender","debounce","callback","waitMillisecond","timer","args","clearTimeout","setTimeout","eventbus","events","Map","emit","targetEvent","get","handler","apply","on","push","set","off","length","delete","handlerIndex","indexOf","splice","mergeObj","destObj","srcObj","key","keys","isDestKeyObj","isSrcKeyObj","isKeyInDest","clonedObj","structuredClone","JSON","parse","stringify","ChartImporter","undefined","chartContent","__ChartContent__","echarts","importChart","importComponent","globalOptions","echartsOptions","chartOptionResolver","options","libsToImport","ignoredProps","includes","components","add","series","charts","type","item","darkmodeObserver","MutationObserver","_","dispose","resizeEvent","getInstanceByDom","resize","sizeSetter","width","style","height","__ChartOptions__","isDarkMode","body","classList","contains","renderMode","chartInst","init","globalOptionsCloned","specificResolved","resultObj","calendarChartDarkModeOptions","splitLine","lineStyle","color","dayLabel","monthLabel","itemStyle","borderWidth","calendar","obj","specificChartResolver","finalOptions","setOption","chartOptions","chartsToImport","componentsToImport","concat","use","importChartLibs","module","darkTheme","registerTheme","observe","attributes","attributeFilter","window","addEventListener","echartsRender","umdImporter","scriptEl","src","globalThis","errMsg","localModuleObj","raphael","flowchartOptions","drawSVG","flowchartRender","diagram","dom","SequenceDiagram","sequenceChartRender","ganttOptions","ganttChartRender","railroadRenderOptions","railroadOptions","ASCIIPattern","CJKPattern","CHAR_WIDTH_before","CHAR_WIDTH","containsCJK","test","isAllContainsASCII","match","matchItem","slice","every","targetCharWidth","renderArgs","Function","rr","Options","assign","VS","verticalGap","AR","arcRadius","INTERNAL_ALIGNMENT","internalAlignment","charWidth","COMMENT_CHAR_WIDTH","commentCharWidth","Diagram","ComplexDiagram","Sequence","Stack","OptionalSequence","AlternatingSequence","Choice","HorizontalChoice","MultipleChoice","Optional","OneOrMore","ZeroOrMore","Group","Start","End","Terminal","NonTerminal","Comment","Skip","Block","railroadChartRender","qrcodeOptions","globalQRCodeOptions","computedStyle","getComputedStyle","frontColor","getPropertyValue","backgroundColor","instOptions","qrcodeContent","__QRCodeContent__","qrcodeWidth","background","content","qrcodeInst","svg","QRCode","qrcodeRender","chartMethodMap","chartRender","chartTypeList","has","targetChartLoadMethod","propToString","val","toString","replaceAll","htmlValueFormater","join","tagName","createTextNode","targetEl","setAttribute","propSetter","childEl","HTMLElement","contentSetter","patternList","tokenize","para","pattern","reduce","accumulator","current","htmlEntityReplace","source","getInterval","text","endSign","includeEscape","intervalText","isEscape","ch","substr","KeyToken_TagName_map","PairedParenMap","katexRenderer","renderModule","TextToken","count","countWord","toHTML","KeyToken","tagSign","tag","realTagName","className","split","__ContainsFormula__","countEntry","formulaImage","class","elOption","parseEntry","LinkToken","address","displayContent","startsWith","target","PhoneticToken","notation","ignoredLeftParenthesis","ignoredRightParenthesis","notationEl","parser","getFirstChar","charAt","substring","getSpecialTokenClass","tokenSign","targetTokenType","tokens","textTerm","keyTerm","keyStart","isInKey","nextCh","specialTokenSign","pairedTokenSign","removedContent","hiddenContent","resultHTML","token","Headline","splited","numberSignStr","numberSignCount","rawContent","id","parsedContent","Para","trimStart","inline","Quote","children","title","NormalTypeEnum","alertPattern","defaultTitle","titleLine","targetType","NoteTypeEnum","TipTypeEnum","ImportantTypeEnum","warningTypeEnum","CautionTypeEnum","titleString","node","headline","innerNodes","description","Symbol","Divider","List","isOrdered","orderedPattern","getContent","childrenHTML","child","unorderedPattern","line","taskListPattern","trimedLine","TaskListItem","prefix","isChecked","inputEl","checked","contentEl","Table","headerCells","bodyRows","tableHeaderCell","tableBodyCell","tableHeaderRow","row","tableBodyRow","tableHeader","tableBody","MediaNode","mdText","containerGenerator","patternGenerator","identifierSign","endsWith","replaceContentGenerator","srcUrlResolver","rawUrl","actualUrl","location","hash","Image","imageEl","alt","loading","tabindex","onclick","e","open","Audio","audioEl","controls","Video","videoEl","isIframePattern","Iframe","iframeEl","sandbox","CodeBlock","isPlaintext","langClass","__LanguageList__","toUpperCase","codeEl","DetailsBlock","summary","summaryEl","detailsEl","childrenEl","FormulaBlock","IframeBlock","__IframeCounter__","injectedCodes","srcdoc","EchartsChartType","__ChartTypeList__","chartEl","FlowChartType","SequenceChartType","GanttChartType","RailroadChartType","QRCodeType","UnknownChartType","ChartBlock","getIndent","indentCount","spaceCount","listResolver","currentLine","lines","currentIndent","currentNode","isListPattern","nextLine","shift","nextIndent","isNextOrdered","unshift","quoteResolver","firstLine","quotedContent","l","mdResolver","tableLineConverter","tableLine","trim","tableResolver","headerText","contentLines","contentRows","blockResolverGenerator","targetClass","codeResolver","chartResolver","formulaResolver","detailsResolver","resolver","iframeResolver","getLines","nodes","keydownEvent","click","scrollToPos","pos","scroll","top","behavior","scrollToEl","offset","offsetTop","scrollToTop","embeddedIframes","setIframeRem","fontSize","contentWindow","postMessage","setIframeTheme","theme","emptyArticlePlaceHolder","articleRender","articleEl","structure","enableCatalog","headlineItems","level","getHeadlines","resultNodes","fragment","createDocumentFragment","loadEvents","allIframeLoaded","onkeydown","lastLeavePage","sessionStorage","getItem","lastLeavePos","removeItem","scrollY","Number","parseInt","newestItemRenderer","createDate","Date","timestamp","dateEl","Intl","DateTimeFormat","format","titleEl","link","directoryItemRenderer","mainEl","querySelector","articleList","dirDescriptionEl","pagingComponent","indexRender","indexing","itemResolver","total","setPage","directoryDescription","remove","indexDirPath","hashChangeEvent","pathManager","homepage","isIn","newestPage","indexPath","pageController","newestIndex","directory","indexFilePath","article","articleContent","status","DOMException","fetchMD","getHash","url","URL","HashChangeEvent","oldURL","newURL","homepagePath","jumpTo","parent","root","testTarget","pageList","next","prev","targetPage","back","pop","btn","PagingView","elements","input","min","max","maxPage","prevBtn","nextBtn","labelEl","appendEvent","targetPageStr","value","isFirstPage","isLastPage","isOnlyPage","disabled","toggle","customElements","define","newest","parentDirBtn","getAttribute","innerText","enableFab","enableSearch","passEvent","isToShow","items","isLoaded","_items","searchBtn","getElementById","lightBtn","darkBtn","setItem","origin","data","navigator","serviceWorker","register"],"mappings":"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"}