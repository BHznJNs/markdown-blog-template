import{aY as e,e as t,bt as o,a2 as i,x as s,bh as n,$ as r,aJ as a,d as l,D as p,_ as d,bU as x}from"./index.js";function u(t,o,i){i=i||{};var s=t.coordinateSystem,n=o.axis,r={},a=n.getAxesOnZeroOf()[0],l=n.position,p=a?"onZero":l,d=n.dim,x=s.getRect(),u=[x.x,x.x+x.width,x.y,x.y+x.height],c={left:0,right:1,top:0,bottom:1,onZero:2},g=o.get("offset")||0,f="x"===d?[u[2]-g,u[3]+g]:[u[0]-g,u[1]+g];if(a){var h=a.toGlobalCoord(a.dataToCoord(0));f[c.onZero]=Math.max(Math.min(h,f[1]),f[0])}r.position=["y"===d?f[c[p]]:u[0],"x"===d?f[c[p]]:u[3]],r.rotation=Math.PI/2*("x"===d?0:1);r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,left:-1,right:1}[l],r.labelOffset=a?f[c[l]]-f[c.onZero]:0,o.get(["axisTick","inside"])&&(r.tickDirection=-r.tickDirection),e(i.labelInside,o.get(["axisLabel","inside"]))&&(r.labelDirection=-r.labelDirection);var v=o.get(["axisLabel","rotate"]);return r.labelRotate="top"===p?-v:v,r.z2=1,r}function c(e){return"cartesian2d"===e.get("coordinateSystem")}function g(e){var s={xAxisModel:null,yAxisModel:null};return t(s,(function(t,n){var r=n.replace(/Model$/,""),a=e.getReferringComponents(r,o).models[0];if(!a)throw new Error(r+' "'+i(e.get(r+"Index"),e.get(r+"Id"),0)+'" not found');s[n]=a})),s}function f(e,o){var i={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(e,o,i){var l=o.getComponent("tooltip"),p=o.getComponent("axisPointer"),d=p.get("link",!0)||[],x=[];t(i.getCoordinateSystems(),(function(i){if(i.axisPointerEnabled){var u=m(i.model),c=e.coordSysAxesInfo[u]={};e.coordSysMap[u]=i;var g=i.model.getModel("tooltip",l);if(t(i.getAxes(),s(A,!1,null)),i.getTooltipAxes&&l&&g.get("show")){var f="axis"===g.get("trigger"),v="cross"===g.get(["axisPointer","type"]),P=i.getTooltipAxes(g.get(["axisPointer","axis"]));(f||v)&&t(P.baseAxes,s(A,!v||"cross",f)),v&&t(P.otherAxes,s(A,"cross",!1))}}function A(s,l,u){var f=u.model.getModel("axisPointer",p),v=f.get("show");if(v&&("auto"!==v||s||y(f))){null==l&&(l=f.get("triggerTooltip")),f=s?function(e,o,i,s,l,p){var d=o.getModel("axisPointer"),x={};t(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],(function(e){x[e]=n(d.get(e))})),x.snap="category"!==e.type&&!!p,"cross"===d.get("type")&&(x.type="line");var u=x.label||(x.label={});if(null==u.show&&(u.show=!1),"cross"===l){var c=d.get(["label","show"]);if(u.show=null==c||c,!p){var g=x.lineStyle=d.get("crossStyle");g&&r(u,g.textStyle)}}return e.model.getModel("axisPointer",new a(x,i,s))}(u,g,p,o,s,l):f;var P=f.get("snap"),A=f.get("triggerEmphasis"),b=m(u.model),I=l||P||"category"===u.type,w=e.axesInfo[b]={key:b,axis:u,coordSys:i,axisPointerModel:f,triggerTooltip:l,triggerEmphasis:A,involveSeries:I,snap:P,useHandle:y(f),seriesModels:[],linkGroup:null};c[b]=w,e.seriesInvolved=e.seriesInvolved||I;var C=function(e,t){for(var o=t.model,i=t.dim,s=0;s<e.length;s++){var n=e[s]||{};if(h(n[i+"AxisId"],o.id)||h(n[i+"AxisIndex"],o.componentIndex)||h(n[i+"AxisName"],o.name))return s}}(d,u);if(null!=C){var M=x[C]||(x[C]={axesInfo:{}});M.axesInfo[b]=w,M.mapper=d[C].mapper,w.linkGroup=M}}}}))}(i,e,o),i.seriesInvolved&&function(e,o){o.eachSeries((function(o){var i=o.coordinateSystem,s=o.get(["tooltip","trigger"],!0),n=o.get(["tooltip","show"],!0);i&&"none"!==s&&!1!==s&&"item"!==s&&!1!==n&&!1!==o.get(["axisPointer","show"],!0)&&t(e.coordSysAxesInfo[m(i.model)],(function(e){var t=e.axis;i.getAxis(t.dim)===t&&(e.seriesModels.push(o),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=o.getData().count())}))}))}(i,e),i}function h(e,t){return"all"===e||l(e)&&p(e,t)>=0||e===t}function v(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[m(e)]}function y(e){return!!e.get(["handle","show"])}function m(e){return e.type+"||"+e.id}var P={},A=function(e){function t(){var o=null!==e&&e.apply(this,arguments)||this;return o.type=t.type,o}return d(t,e),t.prototype.render=function(t,o,i,s){this.axisPointerClass&&function(e){var t=v(e);if(t){var o=t.axisPointerModel,i=t.axis.scale,s=o.option,n=o.get("status"),r=o.get("value");null!=r&&(r=i.parse(r));var a=y(o);null==n&&(s.status=a?"show":"hide");var l=i.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==r||r>l[1])&&(r=l[1]),r<l[0]&&(r=l[0]),s.value=r,a&&(s.status=t.axis.scale.isBlank()?"hide":"show")}}(t),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,i,!0)},t.prototype.updateAxisPointer=function(e,t,o,i){this._doUpdateAxisPointerClass(e,o,!1)},t.prototype.remove=function(e,t){var o=this._axisPointer;o&&o.remove(t)},t.prototype.dispose=function(t,o){this._disposeAxisPointer(o),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(e,o,i){var s=t.getAxisPointerClass(this.axisPointerClass);if(s){var n=function(e){var t=v(e);return t&&t.axisPointerModel}(e);n?(this._axisPointer||(this._axisPointer=new s)).render(e,n,o,i):this._disposeAxisPointer(o)}},t.prototype._disposeAxisPointer=function(e){this._axisPointer&&this._axisPointer.dispose(e),this._axisPointer=null},t.registerAxisPointerClass=function(e,t){if(P[e])throw new Error("axisPointer "+e+" exists");P[e]=t},t.getAxisPointerClass=function(e){return e&&P[e]},t.type="axis",t}(x);export{A,f as c,g as f,v as g,c as i,u as l,m};
