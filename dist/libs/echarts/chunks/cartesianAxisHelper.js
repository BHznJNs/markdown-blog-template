import{f as e,K as t,c as o,d as i,M as s,j as n,q as r,_ as a,C as l,aA as p,av as d,c6 as x}from"./core.js";function u(n,r){var a={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(n,r,a){var l=r.getComponent("tooltip"),p=r.getComponent("axisPointer"),d=p.get("link",!0)||[],x=[];e(a.getCoordinateSystems(),(function(a){if(a.axisPointerEnabled){var u=v(a.model),g=n.coordSysAxesInfo[u]={};n.coordSysMap[u]=a;var h=a.model.getModel("tooltip",l);if(e(a.getAxes(),t(A,!1,null)),a.getTooltipAxes&&l&&h.get("show")){var y="axis"===h.get("trigger"),m="cross"===h.get(["axisPointer","type"]),P=a.getTooltipAxes(h.get(["axisPointer","axis"]));(y||m)&&e(P.baseAxes,t(A,!m||"cross",y)),m&&e(P.otherAxes,t(A,"cross",!1))}}function A(t,l,u){var y=u.model.getModel("axisPointer",p),m=y.get("show");if(m&&("auto"!==m||t||f(y))){null==l&&(l=y.get("triggerTooltip")),y=t?function(t,n,r,a,l,p){var d=n.getModel("axisPointer"),x={};e(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],(function(e){x[e]=o(d.get(e))})),x.snap="category"!==t.type&&!!p,"cross"===d.get("type")&&(x.type="line");var u=x.label||(x.label={});if(null==u.show&&(u.show=!1),"cross"===l){var c=d.get(["label","show"]);if(u.show=null==c||c,!p){var g=x.lineStyle=d.get("crossStyle");g&&i(u,g.textStyle)}}return t.model.getModel("axisPointer",new s(x,r,a))}(u,h,p,r,t,l):y;var P=y.get("snap"),A=y.get("triggerEmphasis"),I=v(u.model),w=l||P||"category"===u.type,C=n.axesInfo[I]={key:I,axis:u,coordSys:a,axisPointerModel:y,triggerTooltip:l,triggerEmphasis:A,involveSeries:w,snap:P,useHandle:f(y),seriesModels:[],linkGroup:null};g[I]=C,n.seriesInvolved=n.seriesInvolved||w;var M=function(e,t){for(var o=t.model,i=t.dim,s=0;s<e.length;s++){var n=e[s]||{};if(c(n[i+"AxisId"],o.id)||c(n[i+"AxisIndex"],o.componentIndex)||c(n[i+"AxisName"],o.name))return s}}(d,u);if(null!=M){var S=x[M]||(x[M]={axesInfo:{}});S.axesInfo[I]=C,S.mapper=d[M].mapper,C.linkGroup=S}}}}))}(a,n,r),a.seriesInvolved&&function(t,o){o.eachSeries((function(o){var i=o.coordinateSystem,s=o.get(["tooltip","trigger"],!0),n=o.get(["tooltip","show"],!0);i&&"none"!==s&&!1!==s&&"item"!==s&&!1!==n&&!1!==o.get(["axisPointer","show"],!0)&&e(t.coordSysAxesInfo[v(i.model)],(function(e){var t=e.axis;i.getAxis(t.dim)===t&&(e.seriesModels.push(o),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=o.getData().count())}))}))}(a,n),a}function c(e,t){return"all"===e||n(e)&&r(e,t)>=0||e===t}function g(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[v(e)]}function f(e){return!!e.get(["handle","show"])}function v(e){return e.type+"||"+e.id}var h={},y=function(e){function t(){var o=null!==e&&e.apply(this,arguments)||this;return o.type=t.type,o}return a(t,e),t.prototype.render=function(t,o,i,s){this.axisPointerClass&&function(e){var t=g(e);if(t){var o=t.axisPointerModel,i=t.axis.scale,s=o.option,n=o.get("status"),r=o.get("value");null!=r&&(r=i.parse(r));var a=f(o);null==n&&(s.status=a?"show":"hide");var l=i.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==r||r>l[1])&&(r=l[1]),r<l[0]&&(r=l[0]),s.value=r,a&&(s.status=t.axis.scale.isBlank()?"hide":"show")}}(t),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,i,!0)},t.prototype.updateAxisPointer=function(e,t,o,i){this._doUpdateAxisPointerClass(e,o,!1)},t.prototype.remove=function(e,t){var o=this._axisPointer;o&&o.remove(t)},t.prototype.dispose=function(t,o){this._disposeAxisPointer(o),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(e,o,i){var s=t.getAxisPointerClass(this.axisPointerClass);if(s){var n=function(e){var t=g(e);return t&&t.axisPointerModel}(e);n?(this._axisPointer||(this._axisPointer=new s)).render(e,n,o,i):this._disposeAxisPointer(o)}},t.prototype._disposeAxisPointer=function(e){this._axisPointer&&this._axisPointer.dispose(e),this._axisPointer=null},t.registerAxisPointerClass=function(e,t){if(h[e])throw new Error("axisPointer "+e+" exists");h[e]=t},t.getAxisPointerClass=function(e){return e&&h[e]},t.type="axis",t}(l);function m(e,t,o){o=o||{};var i=e.coordinateSystem,s=t.axis,n={},r=s.getAxesOnZeroOf()[0],a=s.position,l=r?"onZero":a,d=s.dim,x=i.getRect(),u=[x.x,x.x+x.width,x.y,x.y+x.height],c={left:0,right:1,top:0,bottom:1,onZero:2},g=t.get("offset")||0,f="x"===d?[u[2]-g,u[3]+g]:[u[0]-g,u[1]+g];if(r){var v=r.toGlobalCoord(r.dataToCoord(0));f[c.onZero]=Math.max(Math.min(v,f[1]),f[0])}n.position=["y"===d?f[c[l]]:u[0],"x"===d?f[c[l]]:u[3]],n.rotation=Math.PI/2*("x"===d?0:1);n.labelDirection=n.tickDirection=n.nameDirection={top:-1,bottom:1,left:-1,right:1}[a],n.labelOffset=r?f[c[a]]-f[c.onZero]:0,t.get(["axisTick","inside"])&&(n.tickDirection=-n.tickDirection),p(o.labelInside,t.get(["axisLabel","inside"]))&&(n.labelDirection=-n.labelDirection);var h=t.get(["axisLabel","rotate"]);return n.labelRotate="top"===l?-h:h,n.z2=1,n}function P(e){return"cartesian2d"===e.get("coordinateSystem")}function A(t){var o={xAxisModel:null,yAxisModel:null};return e(o,(function(e,i){var s=i.replace(/Model$/,""),n=t.getReferringComponents(s,d).models[0];if(!n)throw new Error(s+' "'+x(t.get(s+"Index"),t.get(s+"Id"),0)+'" not found');o[i]=n})),o}export{y as A,u as c,A as f,g,P as i,m as l,v as m};
