import{x as e,m as n,Z as t,e as o,D as r,de as a,b8 as i,c8 as s}from"./index.js";import{m as d,a as u,b as c}from"./brushHelper.js";var f=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],l=function(){function e(e,n,t){var a=this;this._targetInfoList=[];var i=p(n,e);o(y,(function(e,n){(!t||!t.include||r(t.include,n)>=0)&&e(i,a._targetInfoList)}))}return e.prototype.setOutputRanges=function(e,n){return this.matchOutputRanges(e,n,(function(e,n,t){if((e.coordRanges||(e.coordRanges=[])).push(n),!e.coordRange){e.coordRange=n;var o=v[e.brushType](0,t,n);e.__rangeOffset={offset:m[e.brushType](o.values,e.range,[1,1]),xyMinMax:o.xyMinMax}}})),e},e.prototype.matchOutputRanges=function(e,n,t){o(e,(function(e){var r=this.findTargetInfo(e,n);r&&!0!==r&&o(r.coordSyses,(function(o){var r=v[e.brushType](1,o,e.range,!0);t(e,r.values,o,n)}))}),this)},e.prototype.setInputRanges=function(e,n){o(e,(function(e){var o,r,a,i,s,d=this.findTargetInfo(e,n);if(t(!d||!0===d||e.coordRange,"coordRange must be specified when coord index specified."),t(!d||!0!==d||e.range,"range must be specified in global brush."),e.range=e.range||[],d&&!0!==d){e.panelId=d.panelId;var u=v[e.brushType](0,d.coordSys,e.coordRange),c=e.__rangeOffset;e.range=c?m[e.brushType](u.values,c.offset,(o=u.xyMinMax,r=c.xyMinMax,a=I(o),i=I(r),s=[a[0]/i[0],a[1]/i[1]],isNaN(s[0])&&(s[0]=1),isNaN(s[1])&&(s[1]=1),s)):u.values}}),this)},e.prototype.makePanelOpts=function(e,t){return n(this._targetInfoList,(function(n){var o=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:t?t(n):null,clipPath:d(o),isTargetByCursor:u(o,e,n.coordSysModel),getLinearBrushOtherExtent:c(o)}}))},e.prototype.controlSeries=function(e,n,t){var o=this.findTargetInfo(e,t);return!0===o||o&&r(o.coordSyses,n.coordinateSystem)>=0},e.prototype.findTargetInfo=function(e,n){for(var t=this._targetInfoList,o=p(n,e),r=0;r<t.length;r++){var a=t[r],i=e.panelId;if(i){if(a.panelId===i)return a}else for(var s=0;s<x.length;s++)if(x[s](o,a))return a}return!0},e}();function g(e){return e[0]>e[1]&&e.reverse(),e}function p(e,n){return a(e,n,{includeMainTypes:f})}var y={grid:function(e,n){var t=e.xAxisModels,a=e.yAxisModels,s=e.gridModels,d=i(),u={},c={};(t||a||s)&&(o(t,(function(e){var n=e.axis.grid.model;d.set(n.id,n),u[n.id]=!0})),o(a,(function(e){var n=e.axis.grid.model;d.set(n.id,n),c[n.id]=!0})),o(s,(function(e){d.set(e.id,e),u[e.id]=!0,c[e.id]=!0})),d.each((function(e){var i=e.coordinateSystem,s=[];o(i.getCartesians(),(function(e,n){(r(t,e.getAxis("x").model)>=0||r(a,e.getAxis("y").model)>=0)&&s.push(e)})),n.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:s[0],coordSyses:s,getPanelRect:h.grid,xAxisDeclared:u[e.id],yAxisDeclared:c[e.id]})})))},geo:function(e,n){o(e.geoModels,(function(e){var t=e.coordinateSystem;n.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:t,coordSyses:[t],getPanelRect:h.geo})}))}},x=[function(e,n){var t=e.xAxisModel,o=e.yAxisModel,r=e.gridModel;return!r&&t&&(r=t.axis.grid.model),!r&&o&&(r=o.axis.grid.model),r&&r===n.gridModel},function(e,n){var t=e.geoModel;return t&&t===n.geoModel}],h={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,n=e.getBoundingRect().clone();return n.applyTransform(s(e)),n}},v={lineX:e(M,0),lineY:e(M,1),rect:function(e,n,t,o){var r=e?n.pointToData([t[0][0],t[1][0]],o):n.dataToPoint([t[0][0],t[1][0]],o),a=e?n.pointToData([t[0][1],t[1][1]],o):n.dataToPoint([t[0][1],t[1][1]],o),i=[g([r[0],a[0]]),g([r[1],a[1]])];return{values:i,xyMinMax:i}},polygon:function(e,t,o,r){var a=[[1/0,-1/0],[1/0,-1/0]];return{values:n(o,(function(n){var o=e?t.pointToData(n,r):t.dataToPoint(n,r);return a[0][0]=Math.min(a[0][0],o[0]),a[1][0]=Math.min(a[1][0],o[1]),a[0][1]=Math.max(a[0][1],o[0]),a[1][1]=Math.max(a[1][1],o[1]),o})),xyMinMax:a}}};function M(e,o,r,a){t("cartesian2d"===r.type,"lineX/lineY brush is available only in cartesian2d.");var i=r.getAxis(["x","y"][e]),s=g(n([0,1],(function(e){return o?i.coordToData(i.toLocalCoord(a[e]),!0):i.toGlobalCoord(i.dataToCoord(a[e]))}))),d=[];return d[e]=s,d[1-e]=[NaN,NaN],{values:s,xyMinMax:d}}var m={lineX:e(T,0),lineY:e(T,1),rect:function(e,n,t){return[[e[0][0]-t[0]*n[0][0],e[0][1]-t[0]*n[0][1]],[e[1][0]-t[1]*n[1][0],e[1][1]-t[1]*n[1][1]]]},polygon:function(e,t,o){return n(e,(function(e,n){return[e[0]-o[0]*t[n][0],e[1]-o[1]*t[n][1]]}))}};function T(e,n,t,o){return[n[0]-o[e]*t[0],n[1]-o[e]*t[1]]}function I(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var b=l,R=function(){},S={};function A(e,n){S[e]=n}function N(e){return S[e]}export{b as B,R as T,N as g,A as r};
