import{G as e,u as t,t as o,j as i,N as r}from"./index.js";import{S as s}from"./Symbol.js";function a(e,t,o,i){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(i.isIgnore&&i.isIgnore(o))&&!(i.clipShape&&!i.clipShape.contain(t[0],t[1]))&&"none"!==e.getItemVisual(o,"symbol")}function n(e){return null==e||r(e)||(e={isIgnore:e}),e||{}}function l(e){var t=e.hostModel,o=t.getModel("emphasis");return{emphasisItemStyle:o.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:o.get("focus"),blurScope:o.get("blurScope"),emphasisDisabled:o.get("disabled"),hoverScale:o.get("scale"),labelStatesModels:i(t),cursorStyle:t.get("cursor")}}var u=function(){function i(t){this.group=new e,this._SymbolCtor=t||s}return i.prototype.updateData=function(e,o){this._progressiveEls=null,o=n(o);var i=this.group,r=e.hostModel,s=this._data,u=this._SymbolCtor,p=o.disableAnimation,m=l(e),c={disableAnimation:p},h=o.getSymbolPoint||function(t){return e.getItemLayout(t)};s||i.removeAll(),e.diff(s).add((function(t){var r=h(t);if(a(e,r,t,o)){var s=new u(e,t,m,c);s.setPosition(r),e.setItemGraphicEl(t,s),i.add(s)}})).update((function(n,l){var d=s.getItemGraphicEl(l),g=h(n);if(a(e,g,n,o)){var y=e.getItemVisual(n,"symbol")||"circle",f=d&&d.getSymbolType&&d.getSymbolType();if(!d||f&&f!==y)i.remove(d),(d=new u(e,n,m,c)).setPosition(g);else{d.updateData(e,n,m,c);var v={x:g[0],y:g[1]};p?d.attr(v):t(d,v,r)}i.add(d),e.setItemGraphicEl(n,d)}else i.remove(d)})).remove((function(e){var t=s.getItemGraphicEl(e);t&&t.fadeOut((function(){i.remove(t)}),r)})).execute(),this._getSymbolPoint=h,this._data=e},i.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl((function(t,o){var i=e._getSymbolPoint(o);t.setPosition(i),t.markRedraw()}))},i.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=l(e),this._data=null,this.group.removeAll()},i.prototype.incrementalUpdate=function(e,t,o){function i(e){e.isGroup||(e.incremental=!0,e.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],o=n(o);for(var r=e.start;r<e.end;r++){var s=t.getItemLayout(r);if(a(t,s,r,o)){var l=new this._SymbolCtor(t,r,this._seriesScope);l.traverse(i),l.setPosition(s),this.group.add(l),t.setItemGraphicEl(r,l),this._progressiveEls.push(l)}}},i.prototype.eachRendered=function(e){o(this._progressiveEls||this.group,e)},i.prototype.remove=function(e){var t=this.group,o=this._data;o&&e?o.eachItemGraphicEl((function(e){e.fadeOut((function(){t.remove(e)}),o.hostModel)})):t.removeAll()},i}();export{u as S};
