import{K as e,o as n,s as o,f as t,q as r,b5 as a,a as i,X as s}from"./core.js";import{m as u,a as d,b as c}from"./brushHelper.js";var f=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],l=function(){function e(e,n,o){var a=this;this._targetInfoList=[];var i=p(n,e);t(y,(function(e,n){(!o||!o.include||r(o.include,n)>=0)&&e(i,a._targetInfoList)}))}return e.prototype.setOutputRanges=function(e,n){return this.matchOutputRanges(e,n,(function(e,n,o){if((e.coordRanges||(e.coordRanges=[])).push(n),!e.coordRange){e.coordRange=n;var t=v[e.brushType](0,o,n);e.__rangeOffset={offset:m[e.brushType](t.values,e.range,[1,1]),xyMinMax:t.xyMinMax}}})),e},e.prototype.matchOutputRanges=function(e,n,o){t(e,(function(e){var r=this.findTargetInfo(e,n);r&&!0!==r&&t(r.coordSyses,(function(t){var r=v[e.brushType](1,t,e.range,!0);o(e,r.values,t,n)}))}),this)},e.prototype.setInputRanges=function(e,n){t(e,(function(e){var t,r,a,i,s,u=this.findTargetInfo(e,n);if(o(!u||!0===u||e.coordRange,"coordRange must be specified when coord index specified."),o(!u||!0!==u||e.range,"range must be specified in global brush."),e.range=e.range||[],u&&!0!==u){e.panelId=u.panelId;var d=v[e.brushType](0,u.coordSys,e.coordRange),c=e.__rangeOffset;e.range=c?m[e.brushType](d.values,c.offset,(t=d.xyMinMax,r=c.xyMinMax,a=I(t),i=I(r),s=[a[0]/i[0],a[1]/i[1]],isNaN(s[0])&&(s[0]=1),isNaN(s[1])&&(s[1]=1),s)):d.values}}),this)},e.prototype.makePanelOpts=function(e,o){return n(this._targetInfoList,(function(n){var t=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:o?o(n):null,clipPath:u(t),isTargetByCursor:d(t,e,n.coordSysModel),getLinearBrushOtherExtent:c(t)}}))},e.prototype.controlSeries=function(e,n,o){var t=this.findTargetInfo(e,o);return!0===t||t&&r(t.coordSyses,n.coordinateSystem)>=0},e.prototype.findTargetInfo=function(e,n){for(var o=this._targetInfoList,t=p(n,e),r=0;r<o.length;r++){var a=o[r],i=e.panelId;if(i){if(a.panelId===i)return a}else for(var s=0;s<x.length;s++)if(x[s](t,a))return a}return!0},e}();function g(e){return e[0]>e[1]&&e.reverse(),e}function p(e,n){return a(e,n,{includeMainTypes:f})}var y={grid:function(e,n){var o=e.xAxisModels,a=e.yAxisModels,s=e.gridModels,u=i(),d={},c={};(o||a||s)&&(t(o,(function(e){var n=e.axis.grid.model;u.set(n.id,n),d[n.id]=!0})),t(a,(function(e){var n=e.axis.grid.model;u.set(n.id,n),c[n.id]=!0})),t(s,(function(e){u.set(e.id,e),d[e.id]=!0,c[e.id]=!0})),u.each((function(e){var i=e.coordinateSystem,s=[];t(i.getCartesians(),(function(e,n){(r(o,e.getAxis("x").model)>=0||r(a,e.getAxis("y").model)>=0)&&s.push(e)})),n.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:s[0],coordSyses:s,getPanelRect:h.grid,xAxisDeclared:d[e.id],yAxisDeclared:c[e.id]})})))},geo:function(e,n){t(e.geoModels,(function(e){var o=e.coordinateSystem;n.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:o,coordSyses:[o],getPanelRect:h.geo})}))}},x=[function(e,n){var o=e.xAxisModel,t=e.yAxisModel,r=e.gridModel;return!r&&o&&(r=o.axis.grid.model),!r&&t&&(r=t.axis.grid.model),r&&r===n.gridModel},function(e,n){var o=e.geoModel;return o&&o===n.geoModel}],h={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,n=e.getBoundingRect().clone();return n.applyTransform(s(e)),n}},v={lineX:e(M,0),lineY:e(M,1),rect:function(e,n,o,t){var r=e?n.pointToData([o[0][0],o[1][0]],t):n.dataToPoint([o[0][0],o[1][0]],t),a=e?n.pointToData([o[0][1],o[1][1]],t):n.dataToPoint([o[0][1],o[1][1]],t),i=[g([r[0],a[0]]),g([r[1],a[1]])];return{values:i,xyMinMax:i}},polygon:function(e,o,t,r){var a=[[1/0,-1/0],[1/0,-1/0]];return{values:n(t,(function(n){var t=e?o.pointToData(n,r):o.dataToPoint(n,r);return a[0][0]=Math.min(a[0][0],t[0]),a[1][0]=Math.min(a[1][0],t[1]),a[0][1]=Math.max(a[0][1],t[0]),a[1][1]=Math.max(a[1][1],t[1]),t})),xyMinMax:a}}};function M(e,t,r,a){o("cartesian2d"===r.type,"lineX/lineY brush is available only in cartesian2d.");var i=r.getAxis(["x","y"][e]),s=g(n([0,1],(function(e){return t?i.coordToData(i.toLocalCoord(a[e]),!0):i.toGlobalCoord(i.dataToCoord(a[e]))}))),u=[];return u[e]=s,u[1-e]=[NaN,NaN],{values:s,xyMinMax:u}}var m={lineX:e(T,0),lineY:e(T,1),rect:function(e,n,o){return[[e[0][0]-o[0]*n[0][0],e[0][1]-o[0]*n[0][1]],[e[1][0]-o[1]*n[1][0],e[1][1]-o[1]*n[1][1]]]},polygon:function(e,o,t){return n(e,(function(e,n){return[e[0]-t[0]*o[n][0],e[1]-t[1]*o[n][1]]}))}};function T(e,n,o,t){return[n[0]-t[e]*o[0],n[1]-t[e]*o[1]]}function I(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var b=l,R=function(){},S={};function A(e,n){S[e]=n}function N(e){return S[e]}export{b as B,R as T,N as g,A as r};
