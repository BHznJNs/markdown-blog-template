import{_ as t,o as e,d as n,m as i,c as a,b as o,i as r,M as s,aw as c,ax as l,t as u,f as d,j as h,aE as p,aF as m,P as g,a2 as x,aH as f,C as y,ay as v,A,aR as b,al as w}from"./core.js";import{a as M}from"./axisDefault.js";import{A as T}from"./AxisBuilder.js";import{a as _}from"./axisAlignTicks.js";import"./labelLayoutHelper.js";var L=M.value;function N(t,e){return n({show:e},t)}var S=function(u){function d(){var t=null!==u&&u.apply(this,arguments)||this;return t.type=d.type,t}return t(d,u),d.prototype.optionUpdated=function(){var t=this.get("boundaryGap"),u=this.get("splitNumber"),d=this.get("scale"),h=this.get("axisLine"),p=this.get("axisTick"),m=this.get("axisLabel"),g=this.get("axisName"),x=this.get(["axisName","show"]),f=this.get(["axisName","formatter"]),y=this.get("axisNameGap"),v=this.get("triggerEvent"),A=e(this.get("indicator")||[],(function(e){null!=e.max&&e.max>0&&!e.min?e.min=0:null!=e.min&&e.min<0&&!e.max&&(e.max=0);var A=g;null!=e.color&&(A=n({color:e.color},g));var b=i(a(e),{boundaryGap:t,splitNumber:u,scale:d,axisLine:h,axisTick:p,axisLabel:m,name:e.text,showName:x,nameLocation:"end",nameGap:y,nameTextStyle:A,triggerEvent:v},!1);if(o(f)){var w=b.name;b.name=f.replace("{value}",null!=w?w:"")}else r(f)&&(b.name=f(b.name,b));var M=new s(b,null,this.ecModel);return c(M,l.prototype),M.mainType="radar",M.componentIndex=this.componentIndex,M}),this);this._indicatorModels=A},d.prototype.getIndicatorModels=function(){return this._indicatorModels},d.type="radar",d.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:i({lineStyle:{color:"#bbb"}},L.axisLine),axisLabel:N(L.axisLabel,!1),axisTick:N(L.axisTick,!1),splitLine:N(L.splitLine,!0),splitArea:N(L.splitArea,!0),indicator:[]},d}(u),I=["axisLine","axisTickLabel","axisName"],k=function(i){function a(){var t=null!==i&&i.apply(this,arguments)||this;return t.type=a.type,t}return t(a,i),a.prototype.render=function(t,e,n){this.group.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t)},a.prototype._buildAxes=function(t){var n=t.coordinateSystem,i=n.getIndicatorAxes(),a=e(i,(function(t){var e=t.model.get("showName")?t.name:"";return new T(t.model,{axisName:e,position:[n.cx,n.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}));d(a,(function(t){d(I,t.add,t),this.group.add(t.getGroup())}),this)},a.prototype._buildSplitLineAndArea=function(t){var i=t.coordinateSystem,a=i.getIndicatorAxes();if(a.length){var o=t.get("shape"),r=t.getModel("splitLine"),s=t.getModel("splitArea"),c=r.getModel("lineStyle"),l=s.getModel("areaStyle"),u=r.get("show"),y=s.get("show"),v=c.get("color"),A=l.get("color"),b=h(v)?v:[v],w=h(A)?A:[A],M=[],T=[];if("circle"===o)for(var _=a[0].getTicksCoords(),L=i.cx,N=i.cy,S=0;S<_.length;S++){if(u)M[j(M,b,S)].push(new p({shape:{cx:L,cy:N,r:_[S].coord}}));if(y&&S<_.length-1)T[j(T,w,S)].push(new m({shape:{cx:L,cy:N,r0:_[S].coord,r:_[S+1].coord}}))}else{var I,k=e(a,(function(t,n){var a=t.getTicksCoords();return I=null==I?a.length-1:Math.min(a.length-1,I),e(a,(function(t){return i.coordToPoint(t.coord,n)}))})),C=[];for(S=0;S<=I;S++){for(var D=[],P=0;P<a.length;P++)D.push(k[P][S]);if(D[0]?D.push(D[0].slice()):console.error("Can't draw value axis "+S),u)M[j(M,b,S)].push(new g({shape:{points:D}}));if(y&&C)T[j(T,w,S-1)].push(new x({shape:{points:D.concat(C)}}));C=D.slice().reverse()}}var E=c.getLineStyle(),G=l.getAreaStyle();d(T,(function(t,e){this.group.add(f(t,{style:n({stroke:"none",fill:w[e%w.length]},G),silent:!0}))}),this),d(M,(function(t,e){this.group.add(f(t,{style:n({fill:"none",stroke:b[e%b.length]},E),silent:!0}))}),this)}function j(t,e,n){var i=n%e.length;return t[i]=t[i]||[],i}},a.type="radar",a}(y),C=function(e){function n(t,n,i){var a=e.call(this,t,n,i)||this;return a.type="value",a.angle=0,a.name="",a}return t(n,e),n}(v),D=function(){function t(t,n,i){this.dimensions=[],this._model=t,this._indicatorAxes=e(t.getIndicatorModels(),(function(t,e){var n="indicator_"+e,i=new C(n,new b);return i.name=t.get("name"),i.model=t,t.axis=i,this.dimensions.push(n),i}),this),this.resize(t,i)}return t.prototype.getIndicatorAxes=function(){return this._indicatorAxes},t.prototype.dataToPoint=function(t,e){var n=this._indicatorAxes[e];return this.coordToPoint(n.dataToCoord(t),e)},t.prototype.coordToPoint=function(t,e){var n=this._indicatorAxes[e].angle;return[this.cx+t*Math.cos(n),this.cy-t*Math.sin(n)]},t.prototype.pointToData=function(t){var e=t[0]-this.cx,n=t[1]-this.cy,i=Math.sqrt(e*e+n*n);e/=i,n/=i;for(var a,o=Math.atan2(-n,e),r=1/0,s=-1,c=0;c<this._indicatorAxes.length;c++){var l=this._indicatorAxes[c],u=Math.abs(o-l.angle);u<r&&(a=l,s=c,r=u)}return[s,+(a&&a.coordToData(i))]},t.prototype.resize=function(t,e){var n=t.get("center"),i=e.getWidth(),a=e.getHeight(),r=Math.min(i,a)/2;this.cx=A(n[0],i),this.cy=A(n[1],a),this.startAngle=t.get("startAngle")*Math.PI/180;var s=t.get("radius");(o(s)||w(s))&&(s=[0,s]),this.r0=A(s[0],r),this.r=A(s[1],r),d(this._indicatorAxes,(function(t,e){t.setExtent(this.r0,this.r);var n=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;n=Math.atan2(Math.sin(n),Math.cos(n)),t.angle=n}),this)},t.prototype.update=function(t,e){var n=this._indicatorAxes,i=this._model;d(n,(function(t){t.scale.setExtent(1/0,-1/0)})),t.eachSeriesByType("radar",(function(e,a){if("radar"===e.get("coordinateSystem")&&t.getComponent("radar",e.get("radarIndex"))===i){var o=e.getData();d(n,(function(t){t.scale.unionExtentFromData(o,o.mapDimension(t.dim))}))}}),this);var a=i.get("splitNumber"),o=new b;o.setExtent(0,a),o.setInterval(1),d(n,(function(t,e){_(t.scale,t.model,o)}))},t.prototype.convertToPixel=function(t,e,n){return console.warn("Not implemented."),null},t.prototype.convertFromPixel=function(t,e,n){return console.warn("Not implemented."),null},t.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},t.create=function(e,n){var i=[];return e.eachComponent("radar",(function(a){var o=new t(a,e,n);i.push(o),a.coordinateSystem=o})),e.eachSeriesByType("radar",(function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=i[t.get("radarIndex")||0])})),i},t.dimensions=[],t}();function P(t){t.registerCoordinateSystem("radar",D),t.registerComponentModel(S),t.registerComponentView(k),t.registerVisual({seriesType:"radar",reset:function(t){var e=t.getData();e.each((function(t){e.setItemVisual(t,"legendIcon","roundRect")})),e.setVisual("legendIcon","roundRect")}})}export{P as install};
