import{_ as t,bL as e,aw as a,bP as o,bS as i,bX as r,bW as n,bV as s,o as u,bt as l,f as p,q as f,j as h,A as c,W as d,b$ as m,i as v,b as g,bB as b,bv as y,bh as x}from"./core.js";import{W as M}from"./whiskerBoxCommon.js";import"./createSeriesDataSimply.js";var D=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.type,t.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],t.visualDrawType="stroke",t}return t(a,e),a.type="series.boxplot",a.dependencies=["xAxis","yAxis","grid"],a.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},a}(e);a(D,M,!0);var S=D,T=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.type,t}return t(a,e),a.prototype.render=function(t,e,a){var i=t.getData(),r=this.group,n=this._data;this._data||r.removeAll();var s="horizontal"===t.get("layout")?1:0;i.diff(n).add((function(t){if(i.hasValue(t)){var e=L(i.getItemLayout(t),i,t,s,!0);i.setItemGraphicEl(t,e),r.add(e)}})).update((function(t,e){var a=n.getItemGraphicEl(e);if(i.hasValue(t)){var u=i.getItemLayout(t);a?(o(a),N(u,a,i,t)):a=L(u,i,t,s),r.add(a),i.setItemGraphicEl(t,a)}else r.remove(a)})).remove((function(t){var e=n.getItemGraphicEl(t);e&&r.remove(e)})).execute(),this._data=i},a.prototype.remove=function(t){var e=this.group,a=this._data;this._data=null,a&&a.eachItemGraphicEl((function(t){t&&e.remove(t)}))},a.type="boxplot",a}(i),w=function(){},I=function(e){function a(t){var a=e.call(this,t)||this;return a.type="boxplotBoxPath",a}return t(a,e),a.prototype.getDefaultShape=function(){return new w},a.prototype.buildPath=function(t,e){var a=e.points,o=0;for(t.moveTo(a[o][0],a[o][1]),o++;o<4;o++)t.lineTo(a[o][0],a[o][1]);for(t.closePath();o<a.length;o++)t.moveTo(a[o][0],a[o][1]),o++,t.lineTo(a[o][0],a[o][1])},a}(r);function L(t,e,a,o,i){var r=t.ends,n=new I({shape:{points:i?W(r,o,t):r}});return N(t,n,e,a,i),n}function N(t,e,a,o,i){var r=a.hostModel;(0,l[i?"initProps":"updateProps"])(e,{shape:{points:t.ends}},r,o),e.useStyle(a.getItemVisual(o,"style")),e.style.strokeNoScale=!0,e.z2=100;var u=a.getItemModel(o),p=u.getModel("emphasis");n(e,u),s(e,p.get("focus"),p.get("blurScope"),p.get("disabled"))}function W(t,e,a){return u(t,(function(t){return(t=t.slice())[e]=a.initBaseline,t}))}var B=T,E=p;function P(t){var e=function(t){var e=[],a=[];return t.eachSeriesByType("boxplot",(function(t){var o=t.getBaseAxis(),i=f(a,o);i<0&&(i=a.length,a[i]=o,e[i]={axis:o,seriesModels:[]}),e[i].seriesModels.push(t)})),e}(t);E(e,(function(t){var e=t.seriesModels;e.length&&(!function(t){var e,a=t.axis,o=t.seriesModels,i=o.length,r=t.boxWidthList=[],n=t.boxOffsetList=[],s=[];if("category"===a.type)e=a.getBandWidth();else{var u=0;E(o,(function(t){u=Math.max(u,t.getData().count())}));var l=a.getExtent();e=Math.abs(l[1]-l[0])/u}E(o,(function(t){var a=t.get("boxWidth");h(a)||(a=[a,a]),s.push([c(a[0],e)||0,c(a[1],e)||0])}));var p=.8*e-2,f=p/i*.3,d=(p-f*(i-1))/i,m=d/2-p/2;E(o,(function(t,e){n.push(m),m+=f+d,r.push(Math.min(Math.max(d,s[e][0]),s[e][1]))}))}(t),E(e,(function(e,a){!function(t,e,a){var o=t.coordinateSystem,i=t.getData(),r=a/2,n="horizontal"===t.get("layout")?0:1,s=1-n,u=["x","y"],l=i.mapDimension(u[n]),p=i.mapDimensionsAll(u[s]);if(null==l||p.length<5)return;for(var f=0;f<i.count();f++){var h=i.get(l,f),c=y(h,p[2],f),d=y(h,p[0],f),m=y(h,p[1],f),v=y(h,p[3],f),g=y(h,p[4],f),b=[];x(b,m,!1),x(b,v,!0),b.push(d,m,g,v),M(b,d),M(b,g),M(b,c),i.setItemLayout(f,{initBaseline:c[s],ends:b})}function y(t,a,r){var u,l=i.get(a,r),p=[];return p[n]=t,p[s]=l,isNaN(t)||isNaN(l)?u=[NaN,NaN]:(u=o.dataToPoint(p))[n]+=e,u}function x(t,e,a){var o=e.slice(),i=e.slice();o[n]+=r,i[n]-=r,a?t.push(o,i):t.push(i,o)}function M(t,e){var a=e.slice(),o=e.slice();a[n]-=r,o[n]+=r,t.push(a,o)}}(e,t.boxOffsetList[a],t.boxWidthList[a])})))}))}var A={type:"echarts:boxplot",transform:function(t){var e=t.upstream;if(e.sourceFormat!==b){var a;a=y("source data is not applicable for this boxplot transform. Expect number[][]."),x(a)}var o=function(t,e){for(var a=[],o=[],i=(e=e||{}).boundIQR,r="none"===i||0===i,n=0;n<t.length;n++){var s=d(t[n].slice()),u=m(s,.25),l=m(s,.5),p=m(s,.75),f=s[0],h=s[s.length-1],c=(null==i?1.5:i)*(p-u),b=r?f:Math.max(f,u-c),y=r?h:Math.min(h,p+c),x=e.itemNameFormatter,M=v(x)?x({value:n}):g(x)?x.replace("{value}",n+""):n+"";a.push([M,b,u,l,p,y]);for(var D=0;D<s.length;D++){var S=s[D];if(S<b||S>y){var T=[M,S];o.push(T)}}}return{boxData:a,outliers:o}}(e.getRawData(),t.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:o.boxData},{data:o.outliers}]}};function Q(t){t.registerSeriesModel(S),t.registerChartView(B),t.registerLayout(P),t.registerTransform(A)}export{Q as install};
